–≤–µ—Å—å –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã : 
–ø–∞–ø–∫–∞ Core  (2 –∫–ª–∞—Å—Å–∞) : 

namespace ScheduleAppDemo .Core
{
 
    public class ObservableObject : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;

        protected virtual void OnPropertyChanged ([CallerMemberName] string propertyName = null)
        {
            PropertyChanged?.Invoke(this , new PropertyChangedEventArgs(propertyName));
        }

        protected bool SetProperty<T> (ref T field , T value , [CallerMemberName] string propertyName = null)
        {
            if ( EqualityComparer<T> .Default .Equals(field , value) )
                return false;

            field = value;
            OnPropertyChanged(propertyName);
            return true;
        }
    }
}

namespace ScheduleAppDemo .Core
{
 public  class RelayCommand : ICommand
    {
        private readonly Action<object> _execute;
        private readonly Func<object , bool> _canExecute;

        public event EventHandler CanExecuteChanged
        {
            add { CommandManager .RequerySuggested += value; }
            remove { CommandManager .RequerySuggested -= value; }
        }

        public RelayCommand (Action<object> execute , Func<object , bool> canExecute = null)
        {
            _execute = execute ?? throw new ArgumentNullException(nameof(execute));
            _canExecute = canExecute;
        }

        public bool CanExecute (object parameter)
        {
            return _canExecute == null || _canExecute(parameter);
        }

        public void Execute (object parameter)
        {
            _execute(parameter);
        }

        // –ú–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã
        public void RaiseCanExecuteChanged ( )
        {
            CommandManager .InvalidateRequerySuggested();
        }
    }
}
–ø–∞–ø–∫–∞ mvvm (4 –ø–∞–ø–∫–∏) :
–ø–∞–ø–∫–∞ Converters (2 –∫–ª–∞—Å—Å–∞) : 

namespace ScheduleAppDemo .MVVM .Converters
{
    // –ü—Ä–æ—Å—Ç–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞
    public class BoolToStatusConverter : IValueConverter
    {
        private static BoolToStatusConverter _instance;
        public static BoolToStatusConverter Instance
        {
            get
            {
                if ( _instance == null )
                    _instance = new BoolToStatusConverter();
                return _instance;
            }
        }

        public object Convert (object value , Type targetType , object parameter , CultureInfo culture)
        {
            if ( value is bool isActive && isActive )
                return "–ê–∫—Ç–∏–≤–Ω–∞";
            return "–ù–µ–∞–∫—Ç–∏–≤–Ω–∞";
        }

        public object ConvertBack (object value , Type targetType , object parameter , CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }

    // –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ü–≤–µ—Ç–∞ –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞
    public class BoolToColorConverter : IValueConverter
    {
        private static BoolToColorConverter _instance;
        public static BoolToColorConverter Instance
        {
            get
            {
                if ( _instance == null )
                    _instance = new BoolToColorConverter();
                return _instance;
            }
        }

        public object Convert (object value , Type targetType , object parameter , CultureInfo culture)
        {
            if ( value is bool isActive && isActive )
                return new SolidColorBrush(Color .FromRgb(76 , 175 , 80)); // –ó–µ–ª–µ–Ω—ã–π
            return new SolidColorBrush(Color .FromRgb(244 , 67 , 54)); // –ö—Ä–∞—Å–Ω—ã–π
        }

        public object ConvertBack (object value , Type targetType , object parameter , CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }

    // –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ü–≤–µ—Ç–∞ –ø–æ –∫—É—Ä—Å—É (–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∑–∞–º–µ–Ω–∏—Ç–µ–ª—å)
    public class YearToColorConverter : IValueConverter
    {
        private static YearToColorConverter _instance;
        public static YearToColorConverter Instance
        {
            get
            {
                if ( _instance == null )
                    _instance = new YearToColorConverter();
                return _instance;
            }
        }

        public object Convert (object value , Type targetType , object parameter , CultureInfo culture)
        {
            if ( value is int year )
            {
                switch ( year )
                {
                    case 1: return new SolidColorBrush(Color .FromRgb(33 , 150 , 243)); // –°–∏–Ω–∏–π
                    case 2: return new SolidColorBrush(Color .FromRgb(76 , 175 , 80));  // –ó–µ–ª–µ–Ω—ã–π
                    case 3: return new SolidColorBrush(Color .FromRgb(255 , 152 , 0));  // –û—Ä–∞–Ω–∂–µ–≤—ã–π
                    case 4: return new SolidColorBrush(Color .FromRgb(156 , 39 , 176)); // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
                    default: return new SolidColorBrush(Color .FromRgb(158 , 158 , 158)); // –°–µ—Ä—ã–π
                }
            }
            return new SolidColorBrush(Colors .Gray);
        }

        public object ConvertBack (object value , Type targetType , object parameter , CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}

namespace ScheduleAppDemo .MVVM .Converters
{
    public class StringToBrushConverter : IValueConverter
    {
        public object Convert (object value , Type targetType , object parameter , CultureInfo culture)
        {
            if ( value is string colorString && !string .IsNullOrEmpty(colorString) )
            {
                try
                {
                    return new SolidColorBrush((Color)ColorConverter .ConvertFromString(colorString));
                }
                catch
                {
                    return new SolidColorBrush(Colors .Gray);
                }
            }
            return new SolidColorBrush(Colors .Gray);
        }

        public object ConvertBack (object value , Type targetType , object parameter , CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}

–ø–∞–ø–∫–∞ Model (1 –∫–ª–∞—Å—Å + –ø–∞–ø–∫–∞ entitis) : 
–ø–∞–ø–∞–∫–∞ —É—Ç–µ—à–µ—à—ã (12 –∫–ª–∞—Å—Å–æ–≤) : 

namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class AcademicWeek
    {
        public DateTime WeekStart { get; set; }
        public DateTime WeekEnd { get; set; }
        public int WeekNumber { get; set; }
        public string DisplayName => $"–ù–µ–¥–µ–ª—è {WeekNumber} ({WeekStart:dd.MM} - {WeekEnd:dd.MM})";
        public bool IsCurrentWeek => DateTime .Now >= WeekStart && DateTime .Now <= WeekEnd;
    }
}

namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class Admin
    {
        public int AdminId { get; set; }
        public string AdminName { get; set; }
        public string AdminLogin { get; set; }
        public string AdminPassword { get; set; }
        public DateTime? LastLogin { get; set; }
    }
}

namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class Classroom
    {
        public int ClassroomId { get; set; }
        public string RoomNumber { get; set; }
        public string RoomType { get; set; }
        public int? Capacity { get; set; }
        public bool? HasComputers { get; set; }
        public bool? IsSpecial { get; set; }
        public bool? IsActive { get; set; }
    }
}

namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class Group
    {
        public int GroupId { get; set; }
        public string GroupName { get; set; }
        public int SpecialtyId { get; set; }
        public int EnrollmentYear { get; set; }
        public int CurrentYear { get; set; }
        public int? StudentCount { get; set; }
        public bool? IsActive { get; set; }
        public DateTime? CreatedDate { get; set; }
        public Specialty Specialty { get; set; }
    }
}

namespace ScheduleAppDemo .MVVM .Model
{
    public class Schedule
    {
        public int ScheduleId { get; set; }

        // –í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏
        public int GroupId { get; set; }
        public int TimeslotId { get; set; }
        public int SubjectId { get; set; }
        public int TeacherId { get; set; }
        public int ClassroomId { get; set; }

        // –î–∞–Ω–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è
        public int DayOfWeek { get; set; } // 1-–ü–Ω, 2-–í—Ç, ..., 6-–°–±
        public bool? IsRemote { get; set; }

        // –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
        public virtual Group Group { get; set; }
        public virtual TimeSlot TimeSlot { get; set; }
        public virtual Subject Subject { get; set; }
        public virtual Teacher Teacher { get; set; }
        public virtual Classroom Classroom { get; set; }

    }
}

namespace ScheduleAppDemo .Services
{
    public class ScheduleSyncService
    {
        private static ScheduleSyncService _instance;
        public static ScheduleSyncService Instance
        {
            get
            {
                if ( _instance == null )
                    _instance = new ScheduleSyncService();
                return _instance;
            }
        }

        public event Action<Group> ScheduleUpdated;

        private ScheduleSyncService ( ) { }

        public void NotifyScheduleUpdated (Group group)
        {
            ScheduleUpdated?.Invoke(group);
        }
    }
}
namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class Specialty
    {
        public int SpecialtyId { get; set; }
        public string SpecialtyName { get; set; }
        public string Abbreviation { get; set; }
        public string Color { get; set; }
        public DateTime? CreatedDate { get; set; }
    }
}
namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class StudyYear
    {
        public int YearId { get; set; }
        public int YearNumber { get; set; }
        public string YearName { get; set; }
    }
}

namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class Subject
    {
        public int SubjectId { get; set; }
        public string SubjectCode { get; set; }
        public string SubjectName { get; set; }
        public int SpecialtyId { get; set; }
        public int StudyYearId { get; set; }
        public int CategoryId { get; set; }
        public int? HoursTotal { get; set; }
        public int? HoursLecture { get; set; }
        public int? HoursPractice { get; set; }
        public bool? HasExam { get; set; }
        public bool? HasPractice { get; set; }
        public bool? IsActive { get; set; }
        public DateTime? CreatedDate { get; set; }
    }
}

namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class SubjectCategory
    {
        public int CategoryId { get; set; }
        public string CategoryName { get; set; }
        public string Description { get; set; }
        public int? DisplayOrder { get; set; }
    }
}

namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public  class Teacher
    {
        public int TeacherId { get; set; }
        public string FullName { get; set; }
        public string Email { get; set; }
        public string Phone { get; set; }
        public bool? IsActive { get; set; }
        public DateTime? CreatedDate { get; set; }
    }
}

namespace ScheduleAppDemo .MVVM .Model .Entities
{
    public class TimeSlot
    {
        public int TimeslotId { get; set; }
        public TimeSpan StartTime { get; set; }
        public TimeSpan EndTime { get; set; }
        public string PeriodName { get; set; }
        public int PeriodOrder { get; set; }
    }
}
–æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å Databasehelper : 

namespace ScheduleAppDemo .MVVM .Model
{
    public static class DatabaseHelper
    {
        private static string ConnectionString = @"Data Source=localhost\MSSQLSERVER01;Initial Catalog=schedule database;Integrated Security=True";

        // ==================== –û–°–ù–û–í–ù–´–ï –ú–ï–¢–û–î–´ –î–õ–Ø –†–ê–°–ü–ò–°–ê–ù–ò–Ø ====================
        // === –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–´ ===
        public static Admin GetAdminInfo (string login , string password)
        {
            return ExecuteReader<Admin>(
                "SELECT admin_id, admin_name, admin_login, admin_password, last_login FROM Admins WHERE admin_login = @Login AND admin_password = @Password" ,
                reader => new Admin
                {
                    AdminId = reader .GetInt32(0) ,
                    AdminName = reader .IsDBNull(1) ? null : reader .GetString(1) ,
                    AdminLogin = reader .GetString(2) ,
                    AdminPassword = reader .GetString(3) ,
                    LastLogin = reader .IsDBNull(4) ? null : (DateTime?)reader .GetDateTime(4)
                } ,
                new SqlParameter("@Login" , login) ,
                new SqlParameter("@Password" , password)
            ) .FirstOrDefault(); // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—É—é –∑–∞–ø–∏—Å—å –∏–ª–∏ null –µ—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        }
        // === –î–õ–Ø –†–ï–î–ê–ö–¢–û–†–ê –†–ê–°–ü–ò–°–ê–ù–ò–Ø ===
        public static void DeleteScheduleForGroup (int groupId)
        {
            ExecuteNonQuery(
                "DELETE FROM Schedule WHERE group_id = @GroupId" ,
                new SqlParameter("@GroupId" , groupId)
            );
        }
        public static void AddScheduleItem (Schedule schedule)
        {
            ExecuteNonQuery(@"
        INSERT INTO Schedule (group_id, subject_id, teacher_id, classroom_id, 
                            timeslot_id, day_of_week, is_remote)
        VALUES (@GroupId, @SubjectId, @TeacherId, @ClassroomId, 
                @TimeslotId, @DayOfWeek, @IsRemote)" ,
                new SqlParameter("@GroupId" , schedule .GroupId) ,
                new SqlParameter("@SubjectId" , schedule .SubjectId) ,
                new SqlParameter("@TeacherId" , schedule .TeacherId) ,
                new SqlParameter("@ClassroomId" , schedule .ClassroomId) ,
                new SqlParameter("@TimeslotId" , schedule .TimeslotId) ,
                new SqlParameter("@DayOfWeek" , schedule .DayOfWeek) ,
                new SqlParameter("@IsRemote" , schedule .IsRemote)  // —É–±—Ä–∞–ª–∏ ?? false
            );
        }


        public static List<Schedule> GetScheduleForGroup (int groupId)
        {
            return ExecuteReader<Schedule>(
                "SELECT schedule_id, group_id, subject_id, teacher_id, classroom_id, timeslot_id, day_of_week, is_remote FROM Schedule WHERE group_id = @GroupId ORDER BY day_of_week, timeslot_id" ,
                reader => new Schedule
                {
                    ScheduleId = reader .GetInt32(0) ,
                    GroupId = reader .GetInt32(1) ,
                    SubjectId = reader .GetInt32(2) ,
                    TeacherId = reader .GetInt32(3) ,
                    ClassroomId = reader .GetInt32(4) ,
                    TimeslotId = reader .GetInt32(5) ,
                    DayOfWeek = reader .GetInt32(6) ,
                    IsRemote = reader .IsDBNull(7) ? false : reader .GetBoolean(7)
                } ,
                new SqlParameter("@GroupId" , groupId)
            );
        }
        // === –û–°–ù–û–í–ù–´–ï GET –ú–ï–¢–û–î–´ ===
        public static List<Group> GetAllGroups ( )
        {
            return GetUniqueEntities<Group>(
                "Groups" ,
                "group_id" ,
                reader => new Group
                {
                    GroupId = reader .GetInt32(0) ,
                    GroupName = reader .GetString(1) ,
                    SpecialtyId = reader .GetInt32(2) ,
                    EnrollmentYear = reader .GetInt32(3) ,
                    CurrentYear = reader .GetInt32(4) ,
                    StudentCount = GetNullableInt(reader , 5) ,
                    IsActive = GetNullableBool(reader , 6) ,
                    CreatedDate = GetNullableDateTime(reader , 7)
                } ,
                "group_name" ,
                "group_name"
            );
        }

        public static List<Subject> GetAllSubjects ( )
        {
            return GetUniqueEntities<Subject>(
                "Subjects" ,
                "subject_id" ,
                reader => new Subject
                {
                    SubjectId = reader .GetInt32(0) ,
                    SubjectCode = reader .GetString(1) ,
                    SubjectName = reader .GetString(2) ,
                    SpecialtyId = reader .GetInt32(3) ,
                    StudyYearId = reader .GetInt32(4) ,
                    CategoryId = reader .GetInt32(5) ,
                    HoursTotal = GetNullableInt(reader , 6) ,
                    HoursLecture = GetNullableInt(reader , 7) ,
                    HoursPractice = GetNullableInt(reader , 8) ,
                    HasExam = GetNullableBool(reader , 9) ,
                    HasPractice = GetNullableBool(reader , 10) ,
                    IsActive = GetNullableBool(reader , 11) ,
                    CreatedDate = GetNullableDateTime(reader , 12)
                } ,
                "subject_code, subject_name" ,
                "subject_name"
            );
        }

        public static List<Teacher> GetAllTeachers ( )
        {
            return GetUniqueEntities<Teacher>(
                "Teachers" ,
                "teacher_id" ,
                reader => new Teacher
                {
                    TeacherId = reader .GetInt32(0) ,
                    FullName = reader .GetString(1) ,
                    Email = GetNullableString(reader , 2) ,
                    Phone = GetNullableString(reader , 3) ,
                    IsActive = GetNullableBool(reader , 4) ,
                    CreatedDate = GetNullableDateTime(reader , 5)
                } ,
                "full_name" ,
                "full_name"
            );
        }

        public static List<Classroom> GetAllClassrooms ( )
        {
            return GetUniqueEntities<Classroom>(
                "Classrooms" ,
                "classroom_id" ,
                reader => new Classroom
                {
                    ClassroomId = reader .GetInt32(0) ,
                    RoomNumber = reader .GetString(1) ,
                    RoomType = reader .GetString(2) ,
                    Capacity = GetNullableInt(reader , 3) ,
                    HasComputers = GetNullableBool(reader , 4) ,
                    IsSpecial = GetNullableBool(reader , 5) ,
                    IsActive = GetNullableBool(reader , 6)
                } ,
                "room_number" ,
                "room_number"
            );
        }

        public static List<TimeSlot> GetTimeSlots ( )
        {
            return ExecuteReader<TimeSlot>(
                "SELECT * FROM TimeSlots ORDER BY period_order" ,
                reader => new TimeSlot
                {
                    TimeslotId = reader .GetInt32(0) ,
                    StartTime = reader .GetTimeSpan(1) ,
                    EndTime = reader .GetTimeSpan(2) ,
                    PeriodName = reader .GetString(3) ,
                    PeriodOrder = reader .GetInt32(4)
                }
            );
        }

        // === –î–õ–Ø –û–°–ù–û–í–ù–û–ì–û –†–ê–°–ü–ò–°–ê–ù–ò–Ø ===
        public static List<StudyYear> GetStudyYears ( )
        {
            return ExecuteReader<StudyYear>(
                "SELECT * FROM StudyYears ORDER BY year_number" ,
                reader => new StudyYear
                {
                    YearId = reader .GetInt32(0) ,
                    YearNumber = reader .GetInt32(1) ,
                    YearName = reader .GetString(2)
                }
            );
        }

        public static List<Specialty> GetSpecialtiesByYear (int yearNumber)
        {
            return ExecuteReader<Specialty>(
                @"SELECT DISTINCT s.specialty_id, s.specialty_name, s.abbreviation, s.color, s.created_date
                  FROM Specialties s
                  INNER JOIN Groups g ON s.specialty_id = g.specialty_id
                  WHERE g.current_year = @YearNumber
                  ORDER BY s.specialty_name" ,
                reader => new Specialty
                {
                    SpecialtyId = reader .GetInt32(0) ,
                    SpecialtyName = reader .GetString(1) ,
                    Abbreviation = reader .GetString(2) ,
                    Color = reader .GetString(3) ,
                    CreatedDate = GetNullableDateTime(reader , 4)
                } ,
                new SqlParameter("@YearNumber" , yearNumber)
            );
        }

        public static List<Group> GetGroupsBySpecialtyAndYear (int specialtyId , int yearNumber)
        {
            return ExecuteReader<Group>(
                @"SELECT * FROM Groups 
                  WHERE specialty_id = @SpecialtyId AND current_year = @YearNumber
                  ORDER BY group_name" ,
                reader => new Group
                {
                    GroupId = reader .GetInt32(0) ,
                    GroupName = reader .GetString(1) ,
                    SpecialtyId = reader .GetInt32(2) ,
                    EnrollmentYear = reader .GetInt32(3) ,
                    CurrentYear = reader .GetInt32(4) ,
                    StudentCount = GetNullableInt(reader , 5) ,
                    IsActive = GetNullableBool(reader , 6) ,
                    CreatedDate = GetNullableDateTime(reader , 7)
                } ,
                new SqlParameter("@SpecialtyId" , specialtyId) ,
                new SqlParameter("@YearNumber" , yearNumber)
            );
        }

        // === –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø ===
        public static bool ValidateAdmin (string login , string password)
        {
            var result = ExecuteScalar<int>(
                "SELECT COUNT(1) FROM Admins WHERE admin_login = @Login AND admin_password = @Password" ,
                new SqlParameter("@Login" , login) ,
                new SqlParameter("@Password" , password)
            );
            return result > 0;
        }

        // ==================== –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ ====================
        private static List<T> GetUniqueEntities<T> (string tableName , string idColumn , Func<SqlDataReader , T> mapper , string groupByColumns , string orderByColumn)
        {
            return ExecuteReader<T>(
                $@"SELECT * FROM {tableName} 
                   WHERE {idColumn} IN (
                       SELECT MIN({idColumn}) 
                       FROM {tableName} 
                       GROUP BY {groupByColumns}
                   )
                   ORDER BY {orderByColumn}" ,
                mapper
            );
        }

        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ ====================
        private static List<T> ExecuteReader<T> (string query , Func<SqlDataReader , T> mapper , params SqlParameter[] parameters)
        {
            var results = new List<T>();
            try
            {
                using ( var connection = new SqlConnection(ConnectionString) )
                {
                    connection .Open();
                    using ( var command = new SqlCommand(query , connection) )
                    {
                        command .Parameters .AddRange(parameters);

                        using ( var reader = command .ExecuteReader() )
                        {
                            while ( reader .Read() )
                            {
                                results .Add(mapper(reader));
                            }
                        }
                    }
                }
            }
            catch ( Exception ex )
            {
                MessageBox .Show($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {ex .Message}");
            }
            return results;
        }
        // === –î–õ–Ø –ì–†–£–ü–ü ===
        public static List<Specialty> GetAllSpecialties ( )
        {
            return ExecuteReader<Specialty>(
                "SELECT specialty_id, specialty_name, abbreviation, color, created_date FROM Specialties ORDER BY specialty_name" ,
                reader => new Specialty
                {
                    SpecialtyId = reader .GetInt32(0) ,
                    SpecialtyName = reader .GetString(1) ,
                    Abbreviation = reader .GetString(2) ,
                    Color = reader .GetString(3) ,
                    CreatedDate = GetNullableDateTime(reader , 4)
                }
            );
        }

        public static bool AddGroup (Group group)
        {
            try
            {
                ExecuteNonQuery(@"
            INSERT INTO Groups (group_name, specialty_id, enrollment_year, current_year, student_count, is_active, created_date)
            VALUES (@GroupName, @SpecialtyId, @EnrollmentYear, @CurrentYear, @StudentCount, @IsActive, @CreatedDate)" ,
                    new SqlParameter("@GroupName" , group .GroupName) ,
                    new SqlParameter("@SpecialtyId" , group .SpecialtyId) ,
                    new SqlParameter("@EnrollmentYear" , group .EnrollmentYear) ,
                    new SqlParameter("@CurrentYear" , group .CurrentYear) ,
                    new SqlParameter("@StudentCount" , (object)group .StudentCount ?? DBNull .Value) ,
                    new SqlParameter("@IsActive" , (object)group .IsActive ?? DBNull .Value) ,
                    new SqlParameter("@CreatedDate" , (object)group .CreatedDate ?? DBNull .Value)
                );
                return true;
            }
            catch ( Exception ex )
            {
                MessageBox .Show($"–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã: {ex .Message}");
                return false;
            }
        }

        public static bool UpdateGroup (Group group)
        {
            try
            {
                ExecuteNonQuery(@"
            UPDATE Groups 
            SET group_name = @GroupName, 
                specialty_id = @SpecialtyId, 
                enrollment_year = @EnrollmentYear,
                current_year = @CurrentYear,
                student_count = @StudentCount,
                is_active = @IsActive
            WHERE group_id = @GroupId" ,
                    new SqlParameter("@GroupId" , group .GroupId) ,
                    new SqlParameter("@GroupName" , group .GroupName) ,
                    new SqlParameter("@SpecialtyId" , group .SpecialtyId) ,
                    new SqlParameter("@EnrollmentYear" , group .EnrollmentYear) ,
                    new SqlParameter("@CurrentYear" , group .CurrentYear) ,
                    new SqlParameter("@StudentCount" , (object)group .StudentCount ?? DBNull .Value) ,
                    new SqlParameter("@IsActive" , (object)group .IsActive ?? DBNull .Value)
                );
                return true;
            }
            catch ( Exception ex )
            {
                MessageBox .Show($"–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã: {ex .Message}");
                return false;
            }
        }

        public static bool DeleteGroup (int groupId)
        {
            try
            {
                ExecuteNonQuery("DELETE FROM Groups WHERE group_id = @GroupId" ,
                    new SqlParameter("@GroupId" , groupId)
                );
                return true;
            }
            catch ( Exception ex )
            {
                MessageBox .Show($"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã: {ex .Message}");
                return false;
            }
        }
        private static void ExecuteNonQuery (string query , params SqlParameter[] parameters)
        {
            try
            {
                using ( var connection = new SqlConnection(ConnectionString) )
                {
                    connection .Open();
                    using ( var command = new SqlCommand(query , connection) )
                    {
                        command .Parameters .AddRange(parameters);
                        command .ExecuteNonQuery();
                    }
                }
            }
            catch ( Exception ex )
            {
                MessageBox .Show($"–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞: {ex .Message}");
                throw;
            }
        }
    
        private static T ExecuteScalar<T> (string query , params SqlParameter[] parameters)
        {
            try
            {
                using ( var connection = new SqlConnection(ConnectionString) )
                {
                    connection .Open();
                    using ( var command = new SqlCommand(query , connection) )
                    {
                        command .Parameters .AddRange(parameters);
                        return (T)command .ExecuteScalar();
                    }
                }
            }
            catch ( Exception ex )
            {
                MessageBox .Show($"–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞: {ex .Message}");
                return default(T);
            }
        }
        // === –ú–ï–¢–û–î–´ –î–õ–Ø –†–ê–ë–û–¢–´ –° –î–ê–¢–ê–ú–ò ===
        public static List<DateTime> GetAcademicYearWeeks (DateTime startDate , int weeksCount)
        {
            var weeks = new List<DateTime>();
            for ( int i = 0 ; i < weeksCount ; i++ )
            {
                weeks .Add(startDate .AddDays(i * 7));
            }
            return weeks;
        }

        public static int GetCurrentWeekNumber (DateTime date)
        {
            var jan1 = new DateTime(date .Year , 1 , 1);
            var daysOffset = DayOfWeek .Monday - jan1 .DayOfWeek;
            var firstMonday = jan1 .AddDays(daysOffset);
            var weekNum = (date - firstMonday) .Days / 7 + 1;
            return weekNum;
        }

        // –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å nullable –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
        private static int? GetNullableInt (SqlDataReader reader , int ordinal)
        {
            return reader .IsDBNull(ordinal) ? null : (int?)reader .GetInt32(ordinal);
        }

        private static bool? GetNullableBool (SqlDataReader reader , int ordinal)
        {
            return reader .IsDBNull(ordinal) ? null : (bool?)reader .GetBoolean(ordinal);
        }

        private static DateTime? GetNullableDateTime (SqlDataReader reader , int ordinal)
        {
            return reader .IsDBNull(ordinal) ? null : (DateTime?)reader .GetDateTime(ordinal);
        }

        private static string GetNullableString (SqlDataReader reader , int ordinal)
        {
            return reader .IsDBNull(ordinal) ? null : reader .GetString(ordinal);
        }
    }
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    public class ScheduleRow
    {
        public string TimeDisplay { get; set; }
        public int TimeSlotId { get; set; }
        public LessonCell Monday { get; set; } = new LessonCell();
        public LessonCell Tuesday { get; set; } = new LessonCell();
        public LessonCell Wednesday { get; set; } = new LessonCell();
        public LessonCell Thursday { get; set; } = new LessonCell();
        public LessonCell Friday { get; set; } = new LessonCell();
        public LessonCell Saturday { get; set; } = new LessonCell();
    }

    public class LessonCell
    {
        public int? ScheduleId { get; set; }
        public string SubjectName { get; set; } = string .Empty;
        public string TeacherName { get; set; } = string .Empty;
        public string Classroom { get; set; } = string .Empty;
        public string Color { get; set; } = "#F5F5F5";
        public bool IsRemote { get; set; }
        public string ToolTip { get; set; } = string .Empty;
        public int? SubjectId { get; set; }
        public int? TeacherId { get; set; }
        public int? ClassroomId { get; set; }
        public string RemoteIcon => IsRemote ? "üíª " : "";
        public string DisplaySubject => RemoteIcon + (string .IsNullOrEmpty(SubjectName) ? "" : SubjectName);
    }
}

–ø–∞–ø–∞–∫–∞ View (6 Viewvs) : 
<UserControl x:Class="ScheduleAppDemo.MVVM.View.LoginView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ScheduleAppDemo.MVVM.View" 
             xmlns:viewmodel="clr-namespace:ScheduleAppDemo.MVVM.ViewModel"
             mc:Ignorable="d" 
             d:DesignHeight="705" d:DesignWidth="880">
    <Border 
        Margin="200,30,200,30"
        CornerRadius="30"
       >
        <Border.Background>
            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                <GradientStop Color="#FF8C2CF1"/>
                <GradientStop Color="#FFB583F3" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="290"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="100"/>
                <RowDefinition />
            </Grid.RowDefinitions>
            <Border
              Height="500"
              Width="400" 
              Margin="48,35,32,10"
              Grid.Row="1" 
              CornerRadius="50"
              Opacity="0.25" 
                Grid.ColumnSpan="3">
                <Border.Background>
                    <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                        <GradientStop Color="#FFFFB289"/>
                        <GradientStop Color="White" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
            </Border>
            <TextBlock 
                Text="–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É"
                Grid.Column="1"
                FontFamily="Arial Black" 
                FontSize="30"
                HorizontalAlignment="Center" 
                Foreground="White" 
                VerticalAlignment="Center" Width="270"/>
            <StackPanel
                Grid.Row="1"
                Grid.Column="1">
                <TextBlock 
                    Text="–õ–æ–≥–∏–Ω" 
                    FontSize="20"
                    Margin="0,150,0,0"
                    Foreground="White"
                    FontWeight="Bold"
                    />
                <TextBox
                    
                 IsEnabled="True" 
                 Focusable="True"
                    x:Name="Logintxtbox" 
                    Style="{StaticResource RoundedTextBoxStyle}"
                         Width="290" 
                         Height="40"
                    Margin="0,5,0,0" FontSize="20"
                    FontFamily="Arial Black"
                    BorderBrush="#FFFFB289"
                    Text="{Binding UserLogin, UpdateSourceTrigger= PropertyChanged}"/>


                <TextBlock
                    Text="–ü–∞—Ä–æ–ª—å"
                    FontWeight="Bold"
                    Foreground="White"
                    FontSize="20" 
                    Margin="0,40,0,0"
                           />
                <PasswordBox
    x:Name="PasswordboxLogin" 
    Style="{StaticResource RoundedTextBoxStyle}"
    Height="40"
    FontSize="20"
    FontFamily="Segoe UI Black"
    BorderBrush="#FFFFB289"
                    />
                <Grid>
                    <Button x:Name="ButtonOKLogin" 
                     Style="{DynamicResource ShadowButtonStyle}"
                          Content="–û–ö"
                          Height="50" 
                          Background="#FFFFB289" 
                          Margin="175,20,10,5" 
                          Foreground="White" 
                          FontFamily="Arial Black" 
                          FontSize="20" 
                          BorderBrush="{x:Null}"
                          Command="{Binding LoginCommand}"
                          CommandParameter="{Binding ElementName=PasswordboxLogin}"
                          >
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="10"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                    <Button  
                           x:Name="ButtonCencelLogin"
                           Style="{StaticResource ShadowButtonStyle}"
                           Content="–û—Ç–º–µ–Ω–∞"
                           Height="50" 
                           Background="#FFFFB289" 
                           Margin="10,20,145,5" 
                           Foreground="White" 
                          FontFamily="Arial Black" 
                           FontSize="20"
                           BorderBrush="{x:Null}"
                           Command="{Binding CancelCommand}"
                           CommandParameter="{Binding ElementName=PasswordboxLogin}">

                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="10"/>
                            </Style>
                        </Button.Resources>
                    </Button>

                </Grid>
            </StackPanel>
            <Image
                Height="200"
                Width="200"
                Grid.Column="1"
                Grid.ColumnSpan="2"
                Margin="175,72,10,373"
                Source="/images/test.png" 
                Stretch="Fill"
                Grid.RowSpan="2"/>
            <Image 
                Grid.Row="1"
                Margin="64,59,265,430"
                Source="/images/user.png" RenderTransformOrigin="0.758,0.28" Grid.ColumnSpan="2"
                />
            <Image 
     Grid.Row="1"
     Margin="257,451,54,32"
     Source="/images/password-lock.png" RenderTransformOrigin="0.91,0.567" Grid.Column="1" Grid.ColumnSpan="2"
     />
        </Grid>
    </Border>
</UserControl>

<UserControl x:Class="ScheduleAppDemo.MVVM.View.NewsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ScheduleAppDemo.MVVM.View" 
             xmlns:viewmodel="clr-namespace:ScheduleAppDemo.MVVM.ViewModel"
           
             mc:Ignorable="d" 
             d:DesignHeight="705" d:DesignWidth="880">
    <Grid Margin="20,20,20,20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition 
               Height="500"/>
        </Grid.RowDefinitions>
        <Border
            Grid.Row="0" 
            CornerRadius="12" 
            Background="#FF4BB1FD"
            Margin="10,44,10,10" 
            RenderTransformOrigin="0.0,0.0" 
            >
            <Border.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform AngleX="0.14"/>
                    <RotateTransform/>
                    <TranslateTransform X="0.123"/>
                </TransformGroup>
            </Border.RenderTransform>
        </Border>
        <Border
            Grid.Column="1"
            CornerRadius="12" 
            Background="#FF854EFF"
          Margin="10,44,10,10" 
    />
        <Border
        Grid.Column="2"
        CornerRadius="12" 
        Margin="10,44,10,10" 
         RenderTransformOrigin="0.0,0.0" 
            Background="#FFEDFF4E">

            <Border.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform AngleX="-0.562"/>
                    <RotateTransform/>
                    <TranslateTransform/>
                </TransformGroup>
            </Border.RenderTransform>

        </Border>
        <TextBlock Text="–ù–æ–≤–æ—Å—Ç–∏" 
                   Height="30"
                   Margin="10,10,0,0"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Top" 
                   FontFamily="Arial Black" 
                   FontSize="20" 
                   Foreground="White"
                   />
        <Border
            Grid.Row="1" 
            CornerRadius="5"
            Margin="10,10,10,10"
            >
            <Border.Background>
                <LinearGradientBrush EndPoint="1,1" StartPoint="1,0">
                    <GradientStop Color="#FF4BB1FD"/>
                    <GradientStop Color="#FFFFD573"
                                  Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
        </Border>
        <Border
    Grid.Row="1" 
            Grid.Column="1"
    CornerRadius="5"
    Margin="10,10,10,10"
    >
            <Border.Background>
                <LinearGradientBrush EndPoint="1,1" StartPoint="1,0">
                    <GradientStop Color="#FF854EFF"/>
                    <GradientStop Color="#FFEDFF4E"
                                  Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
        </Border>
        <Border
    Grid.Row="1" 
            Grid.Column="2"
    CornerRadius="5"
    Margin="10,10,10,10"
    >
            <Border.Background>
                <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                    <GradientStop Color="#FFEDFF4E"/>
                    <GradientStop Color="#FF7AD25B" 
                                  Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
        </Border>
    </Grid>
</UserControl>
<UserControl x:Class="ScheduleAppDemo.MVVM.View.ScheduleEditorView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ScheduleAppDemo.MVVM.View"
             mc:Ignorable="d" 
               d:DesignHeight="705" d:DesignWidth="880">



    <Border  CornerRadius="20">
        <Border.Background>
            <LinearGradientBrush EndPoint="5,1" StartPoint="5,0">
                <GradientStop Color="#FF6500FF"/>
                <GradientStop Color="#FFFFC45B" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>

        <Grid Margin="15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- –®–∞–ø–∫–∞ —Å –≤—ã–±–æ—Ä–æ–º –≥—Ä—É–ø–ø—ã -->
            <Border CornerRadius="15" Background="White" Grid.RowSpan="3" Height="681" VerticalAlignment="Top" Opacity="0.2" Margin="-7,-7,-7,-7"/>

            <!-- –®–∞–ø–∫–∞ —Å –≤—ã–±–æ—Ä–æ–º –≥—Ä—É–ø–ø—ã -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                <TextBlock Text="‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è" 
                      FontSize="22" FontWeight="Bold" 
                      Foreground="White" VerticalAlignment="Center"/>

                <ComboBox ItemsSource="{Binding Groups}" 
                     DisplayMemberPath="GroupName"
                   
                     SelectedItem="{Binding SelectedGroup}"
                     Width="200" Height="30" FontSize="12"
                     Margin="20,0,0,0" 
                      BorderBrush="Black" 
                      Foreground="Black" Background="White"
                      />

            </StackPanel>
            <Border  CornerRadius="20" Height="637" VerticalAlignment="Top" Background="White" Margin="7,38,0,0" Grid.RowSpan="3" BorderBrush="#FF1A1A1A">
                <DataGrid 
              
                 ItemsSource="{Binding ScheduleTable}"
                 AutoGenerateColumns="False"
                 CanUserAddRows="False"
                 IsReadOnly="True"
                 HeadersVisibility="Column"
                 SelectionUnit="Cell"
                 SelectionMode="Single"
                      BorderBrush="White" Background="#FF1A1A1A" Margin="23,24,23,10" Foreground="Black" Grid.RowSpan="2" Grid.Row="1"
                 >

                    <DataGrid.Columns>
                        <!-- –ö–æ–ª–æ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ -->
                        <DataGridTextColumn 
                    Header="–í—Ä–µ–º—è" 
                                   Binding="{Binding TimeDisplay}"
                                   Width="80" IsReadOnly="True"/>

                        <!-- –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ -->
                        <DataGridTemplateColumn Header="–ü–Ω" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="{Binding Monday.Color}" 
                                   CornerRadius="3" Padding="5" Margin="1"
                                   MouseLeftButtonDown="Cell_MouseLeftButtonDown"
                                   Tag="1">
                                        <TextBlock Text="{Binding Monday.DisplaySubject}" 
                                          FontSize="10" TextWrapping="Wrap"
                                          TextAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- –í—Ç–æ—Ä–Ω–∏–∫ -->
                        <DataGridTemplateColumn Header="–í—Ç" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="{Binding Tuesday.Color}" 
                                   CornerRadius="3" Padding="5" Margin="1"
                                   MouseLeftButtonDown="Cell_MouseLeftButtonDown"
                                   Tag="2">
                                        <TextBlock Text="{Binding Tuesday.DisplaySubject}" 
                                          FontSize="10" TextWrapping="Wrap"
                                          TextAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="–°—Ä" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="{Binding Wednesday.Color}" 
                                   CornerRadius="3" Padding="5" Margin="1"
                                   MouseLeftButtonDown="Cell_MouseLeftButtonDown"
                                   Tag="3">
                                        <TextBlock Text="{Binding Wednesday.DisplaySubject}" 
                                          FontSize="10" TextWrapping="Wrap"
                                          TextAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- –ß–µ—Ç–≤–µ—Ä–≥ -->
                        <DataGridTemplateColumn Header="–ß—Ç" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="{Binding Thursday.Color}" 
                                   CornerRadius="3" Padding="5" Margin="1"
                                   MouseLeftButtonDown="Cell_MouseLeftButtonDown"
                                   Tag="4">
                                        <TextBlock Text="{Binding Thursday.DisplaySubject}" 
                                          FontSize="10" TextWrapping="Wrap"
                                          TextAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- –ü—è—Ç–Ω–∏—Ü–∞ -->
                        <DataGridTemplateColumn Header="–ü—Ç" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="{Binding Friday.Color}" 
                                   CornerRadius="3" Padding="5" Margin="1"
                                   MouseLeftButtonDown="Cell_MouseLeftButtonDown"
                                   Tag="5">
                                        <TextBlock Text="{Binding Friday.DisplaySubject}" 
                                          FontSize="10" TextWrapping="Wrap"
                                          TextAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- –°—É–±–±–æ—Ç–∞ -->
                        <DataGridTemplateColumn Header="–°–±" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="{Binding Saturday.Color}" 
                                   CornerRadius="3" Padding="5" Margin="1"
                                   MouseLeftButtonDown="Cell_MouseLeftButtonDown"
                                   Tag="6">
                                        <TextBlock Text="{Binding Saturday.DisplaySubject}" 
                                          FontSize="10" TextWrapping="Wrap"
                                          TextAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>
            <!-- –¢–∞–±–ª–∏—Ü–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è 6√ó6 -->

            <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,15,0,0">
                <Button Content="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë" 
                    Command="{Binding ClearScheduleCommand}"
                    Width="131" Height="35" 
                    Background="#FF6500FF" 
                    Foreground="White"
                    FontSize="12"
                  Style="{StaticResource GlowingRoundedButton}"
                    Margin="0,0,10,10"/>
                <Button Content="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ" 
                    Command="{Binding SaveScheduleCommand}"
                    Width="174" Height="35" 
                    Background="#FF6500FF" 
                    Foreground="White"
                    FontSize="12" 
                      FontWeight="SemiBold"
                     Style="{StaticResource  GlowingRoundedButton}"
                        Margin="0,0,0,10"/>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>

<UserControl x:Class="ScheduleAppDemo.MVVM.View.GroupsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ScheduleAppDemo.MVVM.View"
              xmlns:converters="clr-namespace:ScheduleAppDemo.MVVM.Converters"
             mc:Ignorable="d" 
            d:DesignHeight="705" d:DesignWidth="880">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- –ó–ê–ì–û–õ–û–í–û–ö –ò –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <Border Grid.Row="0" Background="#FF1A1A1A" 
                CornerRadius="10" Padding="12" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏" 
                              FontSize="20" FontWeight="Bold" 
                              Foreground="White"/>
                    <TextBlock Text="–°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—á–µ–±–Ω—ã—Ö –≥—Ä—É–ø–ø"
                              FontSize="11" Foreground="#666" Margin="0,3,0,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="#FFE8F5E8" CornerRadius="6" Padding="8,4" Margin="3,0">
                        <TextBlock Text="{Binding TotalGroups}" FontSize="14" FontWeight="Bold" 
                                  Foreground="#FF4CAF50" HorizontalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="–≥—Ä—É–ø–ø" VerticalAlignment="Center" Margin="3,0,10,0" Foreground="#666" FontSize="11"/>

                    <Border Background="#FFE3F2FD" CornerRadius="6" Padding="8,4" Margin="3,0">
                        <TextBlock Text="{Binding ActiveGroups}" FontSize="14" FontWeight="Bold" 
                                  Foreground="#FF2196F3" HorizontalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="–∞–∫—Ç–∏–≤–Ω—ã—Ö" VerticalAlignment="Center" Margin="3,0,0,0" Foreground="#666" FontSize="11"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
        <Border Grid.Row="1" CornerRadius="8" Padding="12" Margin="0,0,0,10">
            <Border.Background>
                <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                    <GradientStop Color="#FF6500FF"/>
                    <GradientStop Color="#FFFDBF7F" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <StackPanel Orientation="Vertical">
                <!-- –í–ï–†–•–ù–Ø–Ø –°–¢–†–û–ö–ê - –ö–ù–û–ü–ö–ò -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <Button Style="{ StaticResource GlowingRoundedButton}"
                        Content="‚ûï –ù–æ–≤–∞—è –≥—Ä—É–ø–ø–∞" 
                           Command="{Binding AddGroupCommand}"
                           Width="130" Height="32" 
                           Background="#FF1A1A1A" Foreground="White"
                           FontSize="11" FontWeight="SemiBold"
                           BorderThickness="0" />

                    <Button  Style="{ StaticResource GlowingRoundedButton}"
                        Content="üîÑ –û–±–Ω–æ–≤–∏—Ç—å" 
                           Command="{Binding RefreshCommand}"
                           Width="100" Height="32" Margin="10,0,0,0"
                           Background="#FF7D00FF" Foreground="White"
                           FontSize="11" FontWeight="SemiBold"
                           BorderThickness="0" />
                </StackPanel>

                <!-- –ù–ò–ñ–ù–Ø–Ø –°–¢–†–û–ö–ê - –§–ò–õ–¨–¢–†–´ -->
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="–§–∏–ª—å—Ç—Ä—ã:" FontWeight="SemiBold" 
                              VerticalAlignment="Center" Margin="0,0,8,0" Foreground="White" FontSize="11"/>

                    <ComboBox ItemsSource="{Binding StudyYears}" 
                             DisplayMemberPath="YearName"
                             SelectedValuePath="YearId"
                             SelectedValue="{Binding SelectedYearId}"
                             Width="110" Height="28"
                             FontSize="11"
                             Background="White" BorderBrush="#DDD"/>

                    <ComboBox ItemsSource="{Binding Specialties}" 
                             DisplayMemberPath="SpecialtyName"
                             SelectedValuePath="SpecialtyId"
                             SelectedValue="{Binding SelectedSpecialtyId}"
                             Width="180" Height="28" Margin="8,0,0,0"
                             FontSize="11"
                             Background="White" BorderBrush="#DDD"/>

                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                            Width="200" Height="28" Margin="15,0,0,0"
                            FontSize="11" Padding="8,0"
                            Background="White" BorderBrush="#DDD" BorderThickness="1"
                           />
                </StackPanel>
            </StackPanel>
        </Border>

        <Border Grid.Row="2" CornerRadius="15" Background="#FF1A1A1A" BorderThickness="1" BorderBrush="#333" Margin="0,0,0,0">
            <Grid>
                <Border CornerRadius="15" Background="#FF1A1A1A" Margin="1"/>
                <DataGrid x:Name="GroupsDataGrid"
                 ItemsSource="{Binding FilteredGroups}"
                 AutoGenerateColumns="False"
                 CanUserAddRows="False"
                 IsReadOnly="True"
                 HeadersVisibility="Column"
                 SelectionMode="Single"
                 RowHeight="40"
                 BorderThickness="0"
                 Background="Transparent"
                 Foreground="White"
                 VerticalScrollBarVisibility="Auto"
                 Margin="10,10,10,10">

                    <!-- –°–¢–ò–õ–¨ –î–õ–Ø –¢–ï–ú–ù–û–ô –¢–ï–ú–´ -->
                    <DataGrid.Resources>
                        <!-- –°—Ç–∏–ª—å –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∫–æ–ª–æ–Ω–æ–∫ -->
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="#FF2D2D2D"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="Height" Value="35"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="FontSize" Value="11"/>
                            <Setter Property="BorderBrush" Value="#444"/>
                            <Setter Property="Padding" Value="8,0"/>
                        </Style>

                        <!-- –°—Ç–∏–ª—å –¥–ª—è —Å—Ç—Ä–æ–∫ -->
                        <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="BorderBrush" Value="Transparent"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Style>

                        <!-- –°—Ç–∏–ª—å –¥–ª—è —è—á–µ–µ–∫ -->
                        <Style TargetType="DataGridCell">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="BorderBrush" Value="#444"/>
                            <Setter Property="BorderThickness" Value="0,0,0,1"/>
                            <Setter Property="Padding" Value="8,0"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Style>

                        <!-- –°—Ç–∏–ª—å –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–æ–∫—É -->
                       
                    </DataGrid.Resources>

                    <DataGrid.Columns>

                        <!-- –ù–ê–ó–í–ê–ù–ò–ï –ì–†–£–ü–ü–´ -->
                        <DataGridTemplateColumn Header="–ì—Ä—É–ø–ø–∞" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                        <TextBlock Text="üéì" FontSize="12" Margin="0,0,5,0"/>
                                        <TextBlock Text="{Binding GroupName}" 
                                          FontWeight="SemiBold" FontSize="11"
                                          VerticalAlignment="Center" Foreground="White"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- –°–ü–ï–¶–ò–ê–õ–¨–ù–û–°–¢–¨ -->
                        <DataGridTemplateColumn Header="–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å" Width="190">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                        <!-- –í—Ä–µ–º–µ–Ω–Ω—ã–π —Ü–≤–µ—Ç–Ω–æ–π –∫—Ä—É–∂–æ–∫ - –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∫–æ–≥–¥–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç -->
                                        <Border Width="10" Height="10" CornerRadius="5" 
                                      
                                        Margin="0,0,6,0"/>
                                        <TextBlock Text="{Binding Specialty.SpecialtyName}" 
                                          FontSize="11" TextWrapping="Wrap"
                                          VerticalAlignment="Center" Foreground="White"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- –ö–£–†–° -->
                        <DataGridTextColumn Header="–ö—É—Ä—Å" 
                                   Binding="{Binding CurrentYear}" 
                                   Width="80"
                                   Foreground="White"/>

                        <!-- –ì–û–î –ü–û–°–¢–£–ü–õ–ï–ù–ò–Ø -->
                        <DataGridTextColumn Header="–ì–æ–¥ –ø–æ—Å—Ç." 
                                   Binding="{Binding EnrollmentYear}" 
                                   Width="90"
                                   Foreground="White"/>

                        <!-- –°–¢–£–î–ï–ù–¢–û–í -->
                        <DataGridTemplateColumn Header="üë•" Width="90">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="#FF6A5ACD" 
                                   CornerRadius="10" Padding="6,3" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding StudentCount}" 
                                          FontWeight="SemiBold" FontSize="10"
                                          Foreground="White" HorizontalAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- –°–¢–ê–¢–£–° -->
                        <DataGridTemplateColumn Header="–°—Ç–∞—Ç—É—Å" Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border 
                                   CornerRadius="4" Padding="6,3" HorizontalAlignment="Center">
                                        <TextBlock 
                                          FontSize="10" FontWeight="SemiBold"
                                          Foreground="White"
                                          HorizontalAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- –î–ï–ô–°–¢–í–ò–Ø -->
                        <DataGridTemplateColumn Header="–î–µ–π—Å—Ç–≤–∏—è" Width="150">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">

                                        <!-- –ö–ù–û–ü–ö–ê –ü–†–û–°–ú–û–¢–†–ê -->
                                        <Button Content="üëÅÔ∏è" 
                                       ToolTip="–ü—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä—É–ø–ø—ã"
                                       Command="{Binding DataContext.ViewGroupCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                       CommandParameter="{Binding}"
                                       Width="28" Height="28" Margin="2"
                                       Background="#FF2196F3" Foreground="White"
                                       BorderThickness="0" 
                                       FontSize="10"/>

                                        <!-- –ö–ù–û–ü–ö–ê –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø -->
                                        <Button Content="‚úèÔ∏è" 
                                       ToolTip="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
                                       Command="{Binding DataContext.EditGroupCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                       CommandParameter="{Binding}"
                                       Width="28" Height="28" Margin="2"
                                       Background="#FF00D6FF" Foreground="White"
                                       BorderThickness="0" 
                                       FontSize="10"/>

                                        <!-- –ö–ù–û–ü–ö–ê –£–î–ê–õ–ï–ù–ò–Ø -->
                                        <Button Content="üóëÔ∏è" 
                                       ToolTip="–£–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É"
                                       Command="{Binding DataContext.DeleteGroupCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                       CommandParameter="{Binding}"
                                       Width="28" Height="28" Margin="2"
                                       Background="#FFf44336" Foreground="White"
                                       BorderThickness="0" 
                                       FontSize="10"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>
        <!-- –ü–ê–ù–ï–õ–¨ –°–¢–ê–¢–£–°–ê -->
        <Border Grid.Row="3" Background="#FFF0F0F0" CornerRadius="6" Padding="8" Margin="0,8,0,0">
            <TextBlock Text="{Binding StatusMessage}" 
                      FontSize="10" Foreground="#666" 
                      HorizontalAlignment="Center"/>
        </Border>

    </Grid>
</UserControl>


<UserControl x:Class="ScheduleAppDemo.MVVM.View.EditLessonDialog"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ScheduleAppDemo.MVVM.View"
             mc:Ignorable="d" 
            d:DesignHeight="705" d:DesignWidth="440">
    <UserControl.Resources>
        <Style x:Key="DialogGroupBox" TargetType="GroupBox">
            <Setter Property="Margin" Value="10,5"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="BorderBrush" Value="#FF8C43FF"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </UserControl.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
            <TextBlock Text="‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è" 
                      FontSize="20" FontWeight="Bold" 
                      Foreground="Black" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Orientation="Vertical">

                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏ -->
                <GroupBox Header="üìÖ –í—Ä–µ–º—è –∏ –¥–µ–Ω—å" Style="{StaticResource DialogGroupBox}">
                    <TextBlock Text="{Binding TimeInfo}" FontSize="14" FontWeight="SemiBold" TextWrapping="Wrap" Foreground="White"/>
                </GroupBox>

                <!-- –ü—Ä–µ–¥–º–µ—Ç -->
                <GroupBox Header="üìö –ü—Ä–µ–¥–º–µ—Ç" Style="{StaticResource DialogGroupBox}">
                    <ComboBox ItemsSource="{Binding AvailableSubjects}" 
                             DisplayMemberPath="SubjectName"
                             SelectedValue="{Binding SelectedSubjectId}"
                             SelectedValuePath="SubjectId"
                             Height="35"
                             FontSize="12"
                              />
                </GroupBox>

                <!-- –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å -->
                <GroupBox Header="üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å" Style="{StaticResource DialogGroupBox}">
                    <ComboBox ItemsSource="{Binding AvailableTeachers}" 
                             DisplayMemberPath="FullName"
                             SelectedValue="{Binding SelectedTeacherId}"
                             SelectedValuePath="TeacherId"
                             Height="35" FontSize="12"/>
                </GroupBox>

                <!-- –ö–∞–±–∏–Ω–µ—Ç -->
                <GroupBox Header="üè´ –ö–∞–±–∏–Ω–µ—Ç" Style="{StaticResource DialogGroupBox}">
                    <ComboBox ItemsSource="{Binding AvailableClassrooms}" 
                             DisplayMemberPath="RoomNumber"
                             SelectedValue="{Binding SelectedClassroomId}"
                             SelectedValuePath="ClassroomId"
                             Height="35" FontSize="12"/>
                </GroupBox>

                <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ -->
                <GroupBox Header="‚öôÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" Style="{StaticResource DialogGroupBox}">
                    <CheckBox Content="üíª –î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ" 
                             IsChecked="{Binding IsRemote}"
                             FontSize="12"
                             Margin="0,5"/>
                </GroupBox>

                <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä -->
                <GroupBox Header="üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä" Style="{StaticResource DialogGroupBox}">
                    <Border Background="{Binding PreviewColor}" 
                           CornerRadius="5" 
                           Padding="15" 
                           Margin="2"
                           Height="80">
                        <StackPanel>
                            <TextBlock Text="{Binding PreviewSubject}" 
                                      FontWeight="SemiBold" 
                                      FontSize="12"
                                      TextWrapping="Wrap"/>
                            <TextBlock Text="{Binding PreviewTeacher}" 
                                      FontSize="10"
                                      Foreground="#666"
                                      Margin="0,2,0,0"/>
                            <TextBlock Text="{Binding PreviewClassroom}" 
                                      FontSize="10"
                                      Foreground="#666"/>
                        </StackPanel>
                    </Border>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,15,0,0">
            <Button 
                Content="‚ùå –û—Ç–º–µ–Ω–∞" 
                    Click="CancelButton_Click"
                    Width="120" Height="35" 
                    Background="#FFFF4600" 
                    Style="{ StaticResource GlowingRoundedButton}" 
                    Foreground="White"
                    FontSize="12"
                    Margin="0,0,10,0"
                    />
            <Button Content="‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å" 
                    Click="SaveButton_Click"
                    Width="120" Height="35" 
                    Background="#FF60FF66" 
                    Foreground="White"
                    Style="{ StaticResource GlowingRoundedButton}" 
                    FontSize="12" 
                    FontWeight="SemiBold"/>
        </StackPanel>
    </Grid>
</UserControl>



–ø–∞–ø–∫–∞ ViewModel (7 –∫–ª–∞—Å—Å–æ–≤ ) : 

using ScheduleAppDemo .Core;
using ScheduleAppDemo .MVVM .Model;
using ScheduleAppDemo .MVVM .Model .Entities;
using System;
using System .Collections .Generic;
using System .Collections .ObjectModel;
using System .Linq;
using System .Text;
using System .Threading .Tasks;
using System .Windows;

namespace ScheduleAppDemo .MVVM .ViewModel
{
    public class EditLessonViewModel : ObservableObject
    {
        private readonly ScheduleEditorViewModel _parentViewModel;
        private readonly LessonCell _originalCell;
        private readonly int _dayOfWeek;
        private readonly int _timeSlotId;

        public ObservableCollection<Subject> AvailableSubjects { get; set; }
        public ObservableCollection<Teacher> AvailableTeachers { get; set; }
        public ObservableCollection<Classroom> AvailableClassrooms { get; set; }

        private int? _selectedSubjectId;
        private int? _selectedTeacherId;
        private int? _selectedClassroomId;
        private bool _isRemote;

        public int? SelectedSubjectId
        {
            get => _selectedSubjectId;
            set
            {
                SetProperty(ref _selectedSubjectId , value);
                UpdatePreview();
            }
        }

        public int? SelectedTeacherId
        {
            get => _selectedTeacherId;
            set
            {
                SetProperty(ref _selectedTeacherId , value);
                UpdatePreview();
            }
        }

        public int? SelectedClassroomId
        {
            get => _selectedClassroomId;
            set
            {
                SetProperty(ref _selectedClassroomId , value);
                UpdatePreview();
            }
        }

        public bool IsRemote
        {
            get => _isRemote;
            set => SetProperty(ref _isRemote , value);
        }

        // –°–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        public string TimeInfo { get; set; }
        public string PreviewSubject { get; set; }
        public string PreviewTeacher { get; set; }
        public string PreviewClassroom { get; set; }
        public string PreviewColor { get; set; } = "#F5F5F5";

        public EditLessonViewModel (ScheduleEditorViewModel parentViewModel , LessonCell cell , int dayOfWeek , int timeSlotId)
        {
            _parentViewModel = parentViewModel;
            _originalCell = cell;
            _dayOfWeek = dayOfWeek;
            _timeSlotId = timeSlotId;

            AvailableSubjects = new ObservableCollection<Subject>(parentViewModel .Subjects);
            AvailableTeachers = new ObservableCollection<Teacher>(parentViewModel .Teachers);
            AvailableClassrooms = new ObservableCollection<Classroom>(parentViewModel .Classrooms);

            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
            SelectedSubjectId = cell .SubjectId;
            SelectedTeacherId = cell .TeacherId;
            SelectedClassroomId = cell .ClassroomId;
            IsRemote = cell .IsRemote;

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Ä–µ–º–µ–Ω–∏
            SetTimeInfo(dayOfWeek , timeSlotId);
            UpdatePreview();
        }

        private void SetTimeInfo (int dayOfWeek , int timeSlotId)
        {
            string dayName = GetDayName(dayOfWeek);
            var timeSlot = _parentViewModel .TimeSlots .FirstOrDefault(t => t .TimeslotId == timeSlotId);
            string timeInfo = timeSlot != null ?
                $"{timeSlot .StartTime:hh\\:mm}-{timeSlot .EndTime:hh\\:mm} ({timeSlot .PeriodName})" :
                $"–ü–∞—Ä–∞ {timeSlotId}";

            TimeInfo = $"{dayName}, {timeInfo}";
        }

        private string GetDayName (int dayOfWeek)
        {
            switch ( dayOfWeek )
            {
                case 1: return "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫";
                case 2: return "–í—Ç–æ—Ä–Ω–∏–∫";
                case 3: return "–°—Ä–µ–¥–∞";
                case 4: return "–ß–µ—Ç–≤–µ—Ä–≥";
                case 5: return "–ü—è—Ç–Ω–∏—Ü–∞";
                case 6: return "–°—É–±–±–æ—Ç–∞";
                default: return "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –¥–µ–Ω—å";
            }
        }

        private void UpdatePreview ( )
        {
            var subject = AvailableSubjects .FirstOrDefault(s => s .SubjectId == SelectedSubjectId);
            var teacher = AvailableTeachers .FirstOrDefault(t => t .TeacherId == SelectedTeacherId);
            var classroom = AvailableClassrooms .FirstOrDefault(c => c .ClassroomId == SelectedClassroomId);

            PreviewSubject = subject?.SubjectName ?? "–ù–µ –≤—ã–±—Ä–∞–Ω";
            PreviewTeacher = teacher?.FullName ?? "–ù–µ –≤—ã–±—Ä–∞–Ω";
            PreviewClassroom = classroom?.RoomNumber ?? "–ù–µ –≤—ã–±—Ä–∞–Ω";
            PreviewColor = GetLessonColor(SelectedSubjectId);

            OnPropertyChanged(nameof(PreviewSubject));
            OnPropertyChanged(nameof(PreviewTeacher));
            OnPropertyChanged(nameof(PreviewClassroom));
            OnPropertyChanged(nameof(PreviewColor));
        }

        public bool SaveChanges ( )
        {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
            if ( SelectedSubjectId == null || SelectedTeacherId == null || SelectedClassroomId == null )
            {
                MessageBox .Show("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –ø—Ä–µ–¥–º–µ—Ç, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –∏ –∫–∞–±–∏–Ω–µ—Ç" , "–í–Ω–∏–º–∞–Ω–∏–µ");
                return false;
            }

            // –°–æ–∑–¥–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é —è—á–µ–π–∫—É
            var updatedCell = new LessonCell
            {
                SubjectId = SelectedSubjectId ,
                TeacherId = SelectedTeacherId ,
                ClassroomId = SelectedClassroomId ,
                IsRemote = IsRemote ,
                Color = PreviewColor
            };

            // –ó–∞–ø–æ–ª–Ω—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            var subject = AvailableSubjects .FirstOrDefault(s => s .SubjectId == SelectedSubjectId);
            var teacher = AvailableTeachers .FirstOrDefault(t => t .TeacherId == SelectedTeacherId);
            var classroom = AvailableClassrooms .FirstOrDefault(c => c .ClassroomId == SelectedClassroomId);

            updatedCell .SubjectName = subject?.SubjectName ?? "";
            updatedCell .TeacherName = teacher?.FullName ?? "";
            updatedCell .Classroom = classroom?.RoomNumber ?? "";
            updatedCell .ToolTip = $"{updatedCell .SubjectName}\n{updatedCell .TeacherName}\n{updatedCell .Classroom}";

            if ( IsRemote )
            {
                updatedCell .ToolTip += "\nüíª –î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ";
            }

            // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π ViewModel
            _parentViewModel .ApplyLessonEdit(updatedCell , _dayOfWeek , _timeSlotId);

            return true;
        }

        private string GetLessonColor (int? subjectId)
        {
            if ( subjectId == null ) return "#F5F5F5";

            var subject = AvailableSubjects .FirstOrDefault(s => s .SubjectId == subjectId);
            if ( subject == null ) return "#F5F5F5";

            switch ( subject .CategoryId )
            {
                case 1: return "#E3F2FD";
                case 2: return "#E8F5E8";
                case 3: return "#FFF3E0";
                case 4: return "#F3E5F5";
                case 5: return "#E0F2F1";
                case 6: return "#FFEBEE";
                case 7: return "#ECEFF1";
                default: return "#F5F5F5";
            }
        }
    }
}

using ScheduleAppDemo .Core;
using ScheduleAppDemo .MVVM .Model;
using ScheduleAppDemo .MVVM .Model .Entities;
using System;
using System .Collections .Generic;
using System .Collections .ObjectModel;
using System .Linq;
using System .Text;
using System .Threading .Tasks;
using System .Windows;

namespace ScheduleAppDemo .MVVM .ViewModel
{
    public class GroupsViewModel : ObservableObject
    {
        private ObservableCollection<AcademicWeek> _academicWeeks;
        private AcademicWeek _selectedWeek;
        private DateTime _selectedDate = DateTime .Today;
        private ObservableCollection<Group> _groups;
        private ObservableCollection<Group> _filteredGroups;
        private ObservableCollection<StudyYear> _studyYears;
        private ObservableCollection<Specialty> _specialties;

        private string _searchText;
        private int? _selectedYearId;
        private int? _selectedSpecialtyId;
        private string _statusMessage;
        private int _totalGroups;
        private int _activeGroups;

        public GroupsViewModel ( )
        {
            Groups = new ObservableCollection<Group>();
            FilteredGroups = new ObservableCollection<Group>();
            StudyYears = new ObservableCollection<StudyYear>();
            Specialties = new ObservableCollection<Specialty>();

            LoadData();
            InitializeCommands();
        }

        public ObservableCollection<AcademicWeek> AcademicWeeks
        {
            get => _academicWeeks;
            set => SetProperty(ref _academicWeeks , value);
        }

        public AcademicWeek SelectedWeek
        {
            get => _selectedWeek;
            set
            {
                SetProperty(ref _selectedWeek , value);
                if ( value != null )
                    LoadScheduleForWeek(value .WeekStart);
            }
        }

        public DateTime SelectedDate
        {
            get => _selectedDate;
            set
            {
                SetProperty(ref _selectedDate , value);
                LoadScheduleForDate(value);
            }
        }

        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        private void LoadScheduleForWeek (DateTime weekStart)
        {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é
            StatusMessage = $"–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –Ω–µ–¥–µ–ª—é —Å {weekStart:dd.MM.yyyy}";
        }

        private void LoadScheduleForDate (DateTime date)
        {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É
            StatusMessage = $"–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ {date:dd.MM.yyyy}";
        }

        private void InitializeAcademicWeeks ( )
        {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 10 —É—á–µ–±–Ω—ã—Ö –Ω–µ–¥–µ–ª—å –æ—Ç —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
            var startDate = DateTime .Today .AddDays(-(int)DateTime .Today .DayOfWeek + 1); // –ù–∞—á–∞–ª–æ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏
            AcademicWeeks = new ObservableCollection<AcademicWeek>();

            for ( int i = 0 ; i < 10 ; i++ )
            {
                var weekStart = startDate .AddDays(i * 7);
                var weekEnd = weekStart .AddDays(6);
                var week = new AcademicWeek
                {
                    WeekStart = weekStart ,
                    WeekEnd = weekEnd ,
                    WeekNumber = DatabaseHelper .GetCurrentWeekNumber(weekStart)
                };
                AcademicWeeks .Add(week);

                if ( week .IsCurrentWeek )
                    SelectedWeek = week;
            }
        }
        // –°–≤–æ–π—Å—Ç–≤–∞
        public ObservableCollection<Group> Groups
        {
            get => _groups;
            set => SetProperty(ref _groups , value);
        }

        public ObservableCollection<Group> FilteredGroups
        {
            get => _filteredGroups;
            set => SetProperty(ref _filteredGroups , value);
        }

        public ObservableCollection<StudyYear> StudyYears
        {
            get => _studyYears;
            set => SetProperty(ref _studyYears , value);
        }

        public ObservableCollection<Specialty> Specialties
        {
            get => _specialties;
            set => SetProperty(ref _specialties , value);
        }

        public string SearchText
        {
            get => _searchText;
            set
            {
                SetProperty(ref _searchText , value);
                ApplyFilters();
            }
        }

        public int? SelectedYearId
        {
            get => _selectedYearId;
            set
            {
                SetProperty(ref _selectedYearId , value);
                ApplyFilters();
            }
        }

        public int? SelectedSpecialtyId
        {
            get => _selectedSpecialtyId;
            set
            {
                SetProperty(ref _selectedSpecialtyId , value);
                ApplyFilters();
            }
        }

        public string StatusMessage
        {
            get => _statusMessage;
            set => SetProperty(ref _statusMessage , value);
        }

        public int TotalGroups
        {
            get => _totalGroups;
            set => SetProperty(ref _totalGroups , value);
        }

        public int ActiveGroups
        {
            get => _activeGroups;
            set => SetProperty(ref _activeGroups , value);
        }

        // –ö–æ–º–∞–Ω–¥—ã
        public RelayCommand AddGroupCommand { get; private set; }
        public RelayCommand RefreshCommand { get; private set; }
        public RelayCommand ViewGroupCommand { get; private set; }
        public RelayCommand EditGroupCommand { get; private set; }
        public RelayCommand DeleteGroupCommand { get; private set; }

        private void InitializeCommands ( )
        {
            AddGroupCommand = new RelayCommand(o => AddGroup());
            RefreshCommand = new RelayCommand(o => LoadData());
            ViewGroupCommand = new RelayCommand(o => ViewGroup(o as Group));
            EditGroupCommand = new RelayCommand(o => EditGroup(o as Group));
            DeleteGroupCommand = new RelayCommand(o => DeleteGroup(o as Group));
        }

        private void LoadData ( )
        {
            try
            {
                // –ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–ø–ø
                var groups = DatabaseHelper .GetAllGroups();
                Groups .Clear();
                foreach ( var group in groups )
                {
                    Groups .Add(group);
                }

                // –ó–∞–≥—Ä—É–∑–∫–∞ —É—á–µ–±–Ω—ã—Ö –≥–æ–¥–æ–≤
                var years = DatabaseHelper .GetStudyYears();
                StudyYears .Clear();
                StudyYears .Add(new StudyYear { YearId = 0 , YearName = "–í—Å–µ –∫—É—Ä—Å—ã" });
                foreach ( var year in years )
                {
                    StudyYears .Add(year);
                }

                // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π
                var specialties = DatabaseHelper .GetAllSpecialties();
                Specialties .Clear();
                Specialties .Add(new Specialty { SpecialtyId = 0 , SpecialtyName = "–í—Å–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏" });
                foreach ( var specialty in specialties )
                {
                    Specialties .Add(specialty);
                }

                ApplyFilters();
                UpdateStatistics();
                StatusMessage = $"–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ. –í—Å–µ–≥–æ –≥—Ä—É–ø–ø: {Groups .Count}";
            }
            catch ( Exception ex )
            {
                StatusMessage = $"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {ex .Message}";
                MessageBox .Show($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {ex .Message}" , "–û—à–∏–±–∫–∞" ,
                    MessageBoxButton .OK , MessageBoxImage .Error);
            }
        }

        private void ApplyFilters ( )
        {
            if ( Groups == null ) return;

            var filtered = Groups .AsEnumerable();

            // –§–∏–ª—å—Ç—Ä –ø–æ –∫—É—Ä—Å—É
            if ( SelectedYearId .HasValue && SelectedYearId .Value > 0 )
            {
                filtered = filtered .Where(g => g .CurrentYear == SelectedYearId .Value);
            }

            // –§–∏–ª—å—Ç—Ä –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
            if ( SelectedSpecialtyId .HasValue && SelectedSpecialtyId .Value > 0 )
            {
                filtered = filtered .Where(g => g .SpecialtyId == SelectedSpecialtyId .Value);
            }

            // –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–∏—Å–∫–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É
            if ( !string .IsNullOrWhiteSpace(SearchText) )
            {
                var searchLower = SearchText .ToLower();
                filtered = filtered .Where(g =>
                    g .GroupName .ToLower() .Contains(searchLower) ||
                    (g .Specialty?.SpecialtyName?.ToLower() .Contains(searchLower) ?? false));
            }

            FilteredGroups .Clear();
            foreach ( var group in filtered )
            {
                FilteredGroups .Add(group);
            }

            UpdateStatistics();
        }

        private void UpdateStatistics ( )
        {
            TotalGroups = FilteredGroups .Count;
            ActiveGroups = FilteredGroups .Count(g => g .IsActive ?? true);
        }

        private void AddGroup ( )
        {
            try
            {
                // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–∏–∞–ª–æ–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã
                var newGroup = new Group
                {
                    GroupName = "–ù–æ–≤–∞—è –≥—Ä—É–ø–ø–∞" ,
                    EnrollmentYear = DateTime .Now .Year ,
                    CurrentYear = 1 ,
                    IsActive = true ,
                    CreatedDate = DateTime .Now
                };

                // –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é
                Groups .Add(newGroup);
                ApplyFilters();
                StatusMessage = "–ù–æ–≤–∞—è –≥—Ä—É–ø–ø–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ (–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –ø–∞–º—è—Ç—å)";

                MessageBox .Show("–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏" ,
                    "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" , MessageBoxButton .OK , MessageBoxImage .Information);
            }
            catch ( Exception ex )
            {
                StatusMessage = $"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≥—Ä—É–ø–ø—ã: {ex .Message}";
                MessageBox .Show($"–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≥—Ä—É–ø–ø—ã: {ex .Message}" , "–û—à–∏–±–∫–∞" ,
                    MessageBoxButton .OK , MessageBoxImage .Error);
            }
        }

        private void ViewGroup (Group group)
        {
            if ( group == null ) return;

            try
            {
                // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π –≥—Ä—É–ø–ø—ã
                string message = $"–ì—Ä—É–ø–ø–∞: {group .GroupName}\n" +
                               $"–ö—É—Ä—Å: {group .CurrentYear}\n" +
                               $"–ì–æ–¥ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è: {group .EnrollmentYear}\n" +
                               $"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤: {group .StudentCount ?? 0}\n" +
                               $"–°—Ç–∞—Ç—É—Å: {(group .IsActive ?? true ? "–ê–∫—Ç–∏–≤–Ω–∞" : "–ù–µ–∞–∫—Ç–∏–≤–Ω–∞")}";

                MessageBox .Show(message , "–ü—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä—É–ø–ø—ã" ,
                    MessageBoxButton .OK , MessageBoxImage .Information);

                StatusMessage = $"–ü—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä—É–ø–ø—ã: {group .GroupName}";
            }
            catch ( Exception ex )
            {
                StatusMessage = $"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –≥—Ä—É–ø–ø—ã: {ex .Message}";
            }
        }

        private void EditGroup (Group group)
        {
            if ( group == null ) return;

            try
            {
                // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–∏–∞–ª–æ–≥–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                string originalName = group .GroupName;
                group .GroupName = $"{group .GroupName} (–∏–∑–º–µ–Ω–µ–Ω–æ)";

                ApplyFilters();
                StatusMessage = $"–ì—Ä—É–ø–ø–∞ '{originalName}' –æ—Ç–º–µ—á–µ–Ω–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è";

                MessageBox .Show("–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏" ,
                    "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" , MessageBoxButton .OK , MessageBoxImage .Information);
            }
            catch ( Exception ex )
            {
                StatusMessage = $"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥—Ä—É–ø–ø—ã: {ex .Message}";
                MessageBox .Show($"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥—Ä—É–ø–ø—ã: {ex .Message}" , "–û—à–∏–±–∫–∞" ,
                    MessageBoxButton .OK , MessageBoxImage .Error);
            }
        }

        private void DeleteGroup (Group group)
        {
            if ( group == null ) return;

            var result = MessageBox .Show(
                $"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É '{group .GroupName}'?\n\n" +
                "–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å." ,
                "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è" ,
                MessageBoxButton .YesNo ,
                MessageBoxImage .Warning);

            if ( result == MessageBoxResult .Yes )
            {
                try
                {
                    // –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - —É–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
                    Groups .Remove(group);
                    ApplyFilters();
                    StatusMessage = $"–ì—Ä—É–ø–ø–∞ '{group .GroupName}' —É–¥–∞–ª–µ–Ω–∞ (–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑ –ø–∞–º—è—Ç–∏)";

                    MessageBox .Show("–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –ë–î –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏" ,
                        "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è" , MessageBoxButton .OK , MessageBoxImage .Information);
                }
                catch ( Exception ex )
                {
                    StatusMessage = $"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≥—Ä—É–ø–ø—ã: {ex .Message}";
                    MessageBox .Show($"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≥—Ä—É–ø–ø—ã: {ex .Message}" , "–û—à–∏–±–∫–∞" ,
                        MessageBoxButton .OK , MessageBoxImage .Error);
                }
            }
        }
    }
}

using ScheduleAppDemo .Core;
using ScheduleAppDemo .MVVM .Model;
using ScheduleAppDemo .MVVM .View;
using System;
using System .Collections .Generic;
using System .Linq;
using System .Text;
using System .Threading .Tasks;
using System .Windows;
using System .Windows .Controls;

namespace ScheduleAppDemo .MVVM .ViewModel
{
   public class LoginViewModel : ObservableObject
    {
        private MainViewModel _mainViewModel;
        private string _userLogin;
        public string AdminName { get; private set; }
        public string UserLogin
        {
            get => _userLogin;
            set
            {
                _userLogin = value;
                OnPropertyChanged();
            }
        }

        public RelayCommand LoginCommand { get; set; }
        public RelayCommand CancelCommand { get; set; }
        public LoginViewModel (MainViewModel mainViewModel)
        {
            _mainViewModel = mainViewModel;
            LoginCommand = new RelayCommand(LoginExecute);
            CancelCommand = new RelayCommand(CancelExecute);
        }

        private void LoginExecute (object obj)
        {
            if ( obj is PasswordBox passwordBox )
            {
                string password = passwordBox .Password;

                // –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏
                if ( string .IsNullOrEmpty(UserLogin) || string .IsNullOrEmpty(password) )
                {
                    MessageBox .Show("–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å");
                    return;
                }

                // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–µ (–≤–∫–ª—é—á–∞—è –∏–º—è)
                var adminInfo = DatabaseHelper .GetAdminInfo(UserLogin , password);
                if ( adminInfo != null )
                {
                    _mainViewModel .IsAuthenticated = true;
                    _mainViewModel .CurrentAdminName = adminInfo .AdminName; // –ü–µ—Ä–µ–¥–∞–µ–º –∏–º—è
                    _mainViewModel .ShowNewsView();
                }
                else
                {
                    MessageBox .Show("–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å");
                }
            }
        }
        private void CancelExecute (object obj)
        {
            UserLogin = string .Empty;
            if ( obj is PasswordBox passwordBox )
            {
                passwordBox .Password = string .Empty;
            }
        }
    }
}


using ScheduleAppDemo .Core;
using ScheduleAppDemo .MVVM .Model;
using ScheduleAppDemo .MVVM .Model .Entities;
using ScheduleAppDemo .Services;
using System;
using System .Collections .Generic;
using System .Collections .ObjectModel;
using System .Linq;
using System .Windows;
using System .Windows .Input;

namespace ScheduleAppDemo .MVVM .ViewModel
{
    public class MainScheduleViewModel : ObservableObject
    {
        // –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–ª—è ComboBox
        public ObservableCollection<StudyYear> Courses { get; set; }
        public ObservableCollection<Specialty> Specialties { get; set; }
        public ObservableCollection<Group> Groups { get; set; }

        // –í—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        private StudyYear _selectedCourse;
        private Specialty _selectedSpecialty;
        private Group _selectedGroup;

        public StudyYear SelectedCourse
        {
            get { return _selectedCourse; }
            set
            {
                if ( SetProperty(ref _selectedCourse , value) )
                {
                    OnCourseSelected();
                }
            }
        }

        public Specialty SelectedSpecialty
        {
            get { return _selectedSpecialty; }
            set
            {
                if ( SetProperty(ref _selectedSpecialty , value) )
                {
                    OnSpecialtySelected();
                }
            }
        }

        public Group SelectedGroup
        {
            get { return _selectedGroup; }
            set
            {
                if ( SetProperty(ref _selectedGroup , value) )
                {
                    CommandManager .InvalidateRequerySuggested();
                    LoadSchedule();
                }
            }
        }

        // –î–∞–Ω–Ω—ã–µ –¥–ª—è DataGrid
        public ObservableCollection<ScheduleRow> ScheduleRows { get; set; }

        // –ö–æ–º–∞–Ω–¥—ã
        public ICommand LoadScheduleCommand { get; }
        public ICommand RefreshCommand { get; }

        // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
        private List<TimeSlot> _timeSlots;
        private List<Subject> _subjects;
        private List<Teacher> _teachers;
        private List<Classroom> _classrooms;

        public MainScheduleViewModel ( )
        {
            Courses = new ObservableCollection<StudyYear>();
            Specialties = new ObservableCollection<Specialty>();
            Groups = new ObservableCollection<Group>();
            ScheduleRows = new ObservableCollection<ScheduleRow>();

            LoadScheduleCommand = new RelayCommand(
                execute: _ => LoadSchedule() ,
                canExecute: _ => SelectedGroup != null
            );

            RefreshCommand = new RelayCommand(_ => RefreshData());

            // –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (–û–î–ò–ù –†–ê–ó)
            ScheduleSyncService .Instance .ScheduleUpdated += OnScheduleUpdated;

            // –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            System .Diagnostics .Debug .WriteLine("MainScheduleViewModel —Å–æ–∑–¥–∞–Ω");

            LoadInitialData();
        }

        private void LoadInitialData ( )
        {
            try
            {
                System .Diagnostics .Debug .WriteLine("–ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö...");

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫—É—Ä—Å—ã
                var courses = DatabaseHelper .GetStudyYears();
                Courses .Clear();
                foreach ( var course in courses )
                {
                    Courses .Add(course);
                }
                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫—É—Ä—Å–æ–≤: {Courses .Count}");

                // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
                _timeSlots = DatabaseHelper .GetTimeSlots();
                _subjects = DatabaseHelper .GetAllSubjects();
                _teachers = DatabaseHelper .GetAllTeachers();
                _classrooms = DatabaseHelper .GetAllClassrooms();

                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∂–µ–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤: {_timeSlots?.Count ?? 0}");
                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤: {_subjects?.Count ?? 0}");
                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π: {_teachers?.Count ?? 0}");
                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∞—É–¥–∏—Ç–æ—Ä–∏–π: {_classrooms?.Count ?? 0}");

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –∫—É—Ä—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ
                if ( Courses .Count > 0 )
                {
                    SelectedCourse = Courses[0];
                }

            }
            catch ( Exception ex )
            {
                System .Diagnostics .Debug .WriteLine($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {ex .Message}");
                MessageBox .Show($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {ex .Message}");
            }
        }

        private void OnCourseSelected ( )
        {
            if ( SelectedCourse == null ) return;

            try
            {
                System .Diagnostics .Debug .WriteLine($"–í—ã–±—Ä–∞–Ω –∫—É—Ä—Å: {SelectedCourse .YearNumber}");

                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∫—É—Ä—Å–∞
                var specialties = DatabaseHelper .GetSpecialtiesByYear(SelectedCourse .YearNumber);
                Specialties .Clear();
                foreach ( var specialty in specialties )
                {
                    Specialties .Add(specialty);
                }
                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π: {Specialties .Count}");

                // –û—á–∏—â–∞–µ–º –≥—Ä—É–ø–ø—ã
                Groups .Clear();
                SelectedSpecialty = null;
                SelectedGroup = null;
                ScheduleRows .Clear();

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–≤—É—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ—Å—Ç—å
                if ( Specialties .Count > 0 )
                {
                    SelectedSpecialty = Specialties[0];
                }

            }
            catch ( Exception ex )
            {
                System .Diagnostics .Debug .WriteLine($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π: {ex .Message}");
                MessageBox .Show($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π: {ex .Message}");
            }
        }

        private void OnSpecialtySelected ( )
        {
            if ( SelectedSpecialty == null || SelectedCourse == null ) return;

            try
            {
                System .Diagnostics .Debug .WriteLine($"–í—ã–±—Ä–∞–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å: {SelectedSpecialty .SpecialtyName}");

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä—É–ø–ø—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –∫—É—Ä—Å–∞
                var groups = DatabaseHelper .GetGroupsBySpecialtyAndYear(
                    SelectedSpecialty .SpecialtyId ,
                    SelectedCourse .YearNumber
                );

                Groups .Clear();
                foreach ( var group in groups )
                {
                    Groups .Add(group);
                }
                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∂–µ–Ω–æ –≥—Ä—É–ø–ø: {Groups .Count}");

                SelectedGroup = null;
                ScheduleRows .Clear();

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–≤—É—é –≥—Ä—É–ø–ø—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ—Å—Ç—å
                if ( Groups .Count > 0 )
                {
                    SelectedGroup = Groups[0];
                }

            }
            catch ( Exception ex )
            {
                System .Diagnostics .Debug .WriteLine($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä—É–ø–ø: {ex .Message}");
                MessageBox .Show($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥—Ä—É–ø–ø: {ex .Message}");
            }
        }

        private void LoadSchedule ( )
        {
            if ( SelectedGroup == null ) return;

            try
            {
                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –≥—Ä—É–ø–ø—ã: {SelectedGroup .GroupName}");

                // 1. –ü–æ–ª—É—á–∞–µ–º Entity —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏–∑ –ë–î
                var scheduleEntities = DatabaseHelper .GetScheduleForGroup(SelectedGroup .GroupId);
                System .Diagnostics .Debug .WriteLine($"–ù–∞–π–¥–µ–Ω–æ –∑–∞–Ω—è—Ç–∏–π –≤ –ë–î: {scheduleEntities .Count}");

                // 2. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ ScheduleRow –¥–ª—è DataGrid
                var scheduleRows = ConvertToScheduleRows(scheduleEntities);

                // 3. –û–±–Ω–æ–≤–ª—è–µ–º DataGrid
                ScheduleRows .Clear();
                foreach ( var row in scheduleRows )
                {
                    ScheduleRows .Add(row);
                }

                System .Diagnostics .Debug .WriteLine($"–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å—Ç—Ä–æ–∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: {ScheduleRows .Count}");

            }
            catch ( Exception ex )
            {
                System .Diagnostics .Debug .WriteLine($"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: {ex .Message}");
                MessageBox .Show($"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: {ex .Message}");
            }
        }

        private void OnScheduleUpdated (Group updatedGroup)
        {
            System .Diagnostics .Debug .WriteLine($"–ü–æ–ª—É—á–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã: {updatedGroup?.GroupName}");

            // –ï—Å–ª–∏ –æ–±–Ω–æ–≤–∏–ª–æ—Å—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è —Ç–µ–∫—É—â–µ–π –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º
            if ( SelectedGroup != null && updatedGroup != null && SelectedGroup .GroupId == updatedGroup .GroupId )
            {
                System .Diagnostics .Debug .WriteLine("–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è...");
                LoadSchedule();
                MessageBox .Show($"–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –≥—Ä—É–ø–ø—ã {updatedGroup .GroupName} –æ–±–Ω–æ–≤–ª–µ–Ω–æ!" , "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ" ,
                    MessageBoxButton .OK , MessageBoxImage .Information);
            }
        }

        private void RefreshData ( )
        {
            System .Diagnostics .Debug .WriteLine("–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...");

            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
            LoadInitialData();
            if ( SelectedGroup != null )
            {
                LoadSchedule();
            }
        }

        private List<ScheduleRow> ConvertToScheduleRows (List<Schedule> scheduleEntities)
        {
            var rows = new List<ScheduleRow>();

            if ( _timeSlots == null || _timeSlots .Count == 0 )
            {
                System .Diagnostics .Debug .WriteLine("–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã");
                MessageBox .Show("–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã");
                return rows;
            }

            // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–ª–æ—Ç–∞
            foreach ( var timeSlot in _timeSlots .OrderBy(ts => ts .PeriodOrder) )
            {
                var row = new ScheduleRow
                {
                    TimeDisplay = $"{timeSlot .StartTime:hh\\:mm}-{timeSlot .EndTime:hh\\:mm}\n{timeSlot .PeriodName}" ,
                    TimeSlotId = timeSlot .TimeslotId
                };

                // –ó–∞–ø–æ–ª–Ω—è–µ–º —è—á–µ–π–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è –Ω–µ–¥–µ–ª–∏
                for ( int day = 1 ; day <= 6 ; day++ )
                {
                    var lesson = scheduleEntities .FirstOrDefault(s =>
                        s .TimeslotId == timeSlot .TimeslotId && s .DayOfWeek == day);

                    if ( lesson != null )
                    {
                        var lessonCell = CreateLessonCell(lesson);
                        SetDayCell(row , day , lessonCell);
                    }
                    else
                    {
                        // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—É—é —è—á–µ–π–∫—É
                        SetDayCell(row , day , new LessonCell());
                    }
                }

                rows .Add(row);
            }

            System .Diagnostics .Debug .WriteLine($"–°–æ–∑–¥–∞–Ω–æ —Å—Ç—Ä–æ–∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: {rows .Count}");
            return rows;
        }

        private LessonCell CreateLessonCell (Schedule schedule)
        {
            var subject = _subjects?.FirstOrDefault(s => s .SubjectId == schedule .SubjectId);
            var teacher = _teachers?.FirstOrDefault(t => t .TeacherId == schedule .TeacherId);
            var classroom = _classrooms?.FirstOrDefault(c => c .ClassroomId == schedule .ClassroomId);

            string subjectName = subject?.SubjectName ?? "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç";
            string teacherName = teacher?.FullName ?? "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –Ω–µ —É–∫–∞–∑–∞–Ω";
            string classroomNumber = classroom?.RoomNumber ?? "–ö–∞–±–∏–Ω–µ—Ç –Ω–µ —É–∫–∞–∑–∞–Ω";

            // –û–±—Ä–µ–∑–∞–µ–º –¥–ª–∏–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤
            if ( subjectName .Length > 30 )
                subjectName = subjectName .Substring(0 , 27) + "...";

            return new LessonCell
            {
                ScheduleId = schedule .ScheduleId ,
                SubjectName = subjectName ,
                TeacherName = teacherName ,
                Classroom = classroomNumber ,
                SubjectId = subject?.SubjectId ,
                TeacherId = teacher?.TeacherId ,
                ClassroomId = classroom?.ClassroomId ,
                Color = GetLessonColor(subject?.CategoryId) ,
                IsRemote = schedule .IsRemote ?? false ,
                ToolTip = CreateToolTip(subjectName , teacherName , classroomNumber , schedule .IsRemote ?? false)
            };
        }

        private string CreateToolTip (string subject , string teacher , string classroom , bool isRemote)
        {
            var tooltip = $"{subject}\n–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: {teacher}\n–ö–∞–±–∏–Ω–µ—Ç: {classroom}";
            if ( isRemote )
                tooltip += "\nüíª –î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ";
            return tooltip;
        }

        private void SetDayCell (ScheduleRow row , int dayOfWeek , LessonCell cell)
        {
            switch ( dayOfWeek )
            {
                case 1: row .Monday = cell; break;
                case 2: row .Tuesday = cell; break;
                case 3: row .Wednesday = cell; break;
                case 4: row .Thursday = cell; break;
                case 5: row .Friday = cell; break;
                case 6: row .Saturday = cell; break;
            }
        }

        private string GetLessonColor (int? categoryId)
        {
            if ( categoryId == null ) return "#F5F5F5";

            switch ( categoryId .Value )
            {
                case 1: return "#E3F2FD"; // –û–û–î - –≥–æ–ª—É–±–æ–π
                case 2: return "#E8F5E8"; // –û–ì–°–≠ - –∑–µ–ª–µ–Ω—ã–π
                case 3: return "#FFF3E0"; // –ï–ù - –æ—Ä–∞–Ω–∂–µ–≤—ã–π
                case 4: return "#F3E5F5"; // –û–ü–¶ - —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π
                case 5: return "#E0F2F1"; // –ü–ú - –±–∏—Ä—é–∑–æ–≤—ã–π
                case 6: return "#FFEBEE"; // –ú–î–ö - —Ä–æ–∑–æ–≤—ã–π
                case 7: return "#ECEFF1"; // –ü–†–ê–ö–¢–ò–ö–ê - —Å–µ—Ä—ã–π
                default: return "#F5F5F5"; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
            }
        }
    }
}

using ScheduleAppDemo .Core;
using ScheduleAppDemo .MVVM .View;
using System;
using System .Windows;
using System .Windows .Input;

namespace ScheduleAppDemo .MVVM .ViewModel
{
    public class MainViewModel : ObservableObject
    {
        // –ö–æ–º–∞–Ω–¥—ã
        public RelayCommand CloseAppCommand { get; set; }
        public RelayCommand LoginViewCommand { get; set; }
        public RelayCommand MainScheduleViewCommand { get; set; }
        public RelayCommand ScheduleEditorViewCommand { get; set; }
        public RelayCommand NewsViewCommand { get; set; }
        public RelayCommand GroupsViewCommand { get; set; }
        public RelayCommand InfoEditorViewCommand { get; set; }

        // ViewModels
        public LoginViewModel LoginView { get; set; }
        public MainScheduleViewModel MainScheduleVM { get; set; }
        public NewsViewModel NewsVM { get; set; }
        public ScheduleEditorViewModel ScheduleEditorVM { get; set; }
        public GroupsViewModel GroupsVM { get; set; }

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
        private bool _isMainScheduleActive = false;
        private bool _isScheduleEditorActive = false;
        private bool _isGroupsActive = false;
        private bool _isInfoEditorActive = false;

        public bool IsMainScheduleActive
        {
            get => _isMainScheduleActive;
            set => SetProperty(ref _isMainScheduleActive , value);
        }

        public bool IsScheduleEditorActive
        {
            get => _isScheduleEditorActive;
            set => SetProperty(ref _isScheduleEditorActive , value);
        }

        public bool IsGroupsActive
        {
            get => _isGroupsActive;
            set => SetProperty(ref _isGroupsActive , value);
        }

        public bool IsInfoEditorActive
        {
            get => _isInfoEditorActive;
            set => SetProperty(ref _isInfoEditorActive , value);
        }

        // –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        private string _currentAdminName;
        public string CurrentAdminName
        {
            get => _currentAdminName;
            set => SetProperty(ref _currentAdminName , value);
        }

        private bool _isAuthenticated = false;
        public bool IsAuthenticated
        {
            get => _isAuthenticated;
            set
            {
                if ( SetProperty(ref _isAuthenticated , value) )
                {
                    // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥
                    OnPropertyChanged(nameof(IsAuthenticated));

                    // –ï—Å–ª–∏ –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —ç–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞
                    if ( !value )
                    {
                        CurrentView = LoginView;
                        ResetAllButtons();
                    }
                }
            }
        }

        private object _currentView;
        public object CurrentView
        {
            get => _currentView;
            set
            {
                if ( SetProperty(ref _currentView , value) )
                {
                    System .Diagnostics .Debug .WriteLine($"CurrentView changed to: {value?.GetType() .Name}");

                    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–∫–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ View
                    UpdateWindowTitle();
                }
            }
        }

        public MainViewModel ( )
        {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ViewModels
            InitializeViewModels();

            // –°—Ç–∞—Ä—Ç–æ–≤–æ–µ –æ–∫–Ω–æ - –ª–æ–≥–∏–Ω
            CurrentView = LoginView;

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
            InitializeCommands();

            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –æ–∫–Ω–∞
            UpdateWindowTitle();
        }

        private void InitializeViewModels ( )
        {
            LoginView = new LoginViewModel(this);
            MainScheduleVM = new MainScheduleViewModel();
            NewsVM = new NewsViewModel(this);
            ScheduleEditorVM = new ScheduleEditorViewModel();
            GroupsVM = new GroupsViewModel();
        }

        private void InitializeCommands ( )
        {
            CloseAppCommand = new RelayCommand(o => Application .Current .Shutdown());

            LoginViewCommand = new RelayCommand(o =>
            {
                if ( CurrentView != LoginView )
                {
                    CurrentView = LoginView;
                    ResetAllButtons();
                }
            });

            MainScheduleViewCommand = new RelayCommand(o =>
            {
                if ( CurrentView != MainScheduleVM )
                {
                    CurrentView = MainScheduleVM;
                    SetActiveButton("MainSchedule");
                }
            } , o => IsAuthenticated); // –ö–æ–º–∞–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

            ScheduleEditorViewCommand = new RelayCommand(o =>
            {
                if ( CurrentView != ScheduleEditorVM )
                {
                    CurrentView = ScheduleEditorVM;
                    SetActiveButton("ScheduleEditor");
                }
            } , o => IsAuthenticated);

            NewsViewCommand = new RelayCommand(o =>
            {
                if ( CurrentView != NewsVM )
                {
                    CurrentView = NewsVM;
                    ResetAllButtons();
                }
            } , o => IsAuthenticated);

            GroupsViewCommand = new RelayCommand(o =>
            {
                if ( CurrentView != GroupsVM )
                {
                    CurrentView = GroupsVM;
                    SetActiveButton("Groups");
                }
            } , o => IsAuthenticated);

            InfoEditorViewCommand = new RelayCommand(o =>
            {
                // –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–≥–ª—É—à–∫–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ–º ScheduleEditor
                // TODO: –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π InfoEditorViewModel –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤
                if ( CurrentView != ScheduleEditorVM )
                {
                    CurrentView = ScheduleEditorVM;
                    SetActiveButton("InfoEditor");
                }
            } , o => IsAuthenticated);
        }

        private void SetActiveButton (string buttonName)
        {
            // –°–Ω–∞—á–∞–ª–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ
            ResetAllButtons();

            // –ó–∞—Ç–µ–º –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—É—é –∫–Ω–æ–ø–∫—É
            switch ( buttonName )
            {
                case "MainSchedule":
                    IsMainScheduleActive = true;
                    break;
                case "ScheduleEditor":
                    IsScheduleEditorActive = true;
                    break;
                case "Groups":
                    IsGroupsActive = true;
                    break;
                case "InfoEditor":
                    IsInfoEditorActive = true;
                    break;
            }
        }

        private void ResetAllButtons ( )
        {
            IsMainScheduleActive = false;
            IsScheduleEditorActive = false;
            IsGroupsActive = false;
            IsInfoEditorActive = false;
        }

        private void UpdateWindowTitle ( )
        {
            string viewName = CurrentView?.GetType() .Name .Replace("ViewModel" , "") ?? "Unknown";
            string adminInfo = !string .IsNullOrEmpty(CurrentAdminName) ? $" - {CurrentAdminName}" : "";

            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–∫–Ω–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            // Application.Current.MainWindow.Title = $"Schedule App - {viewName}{adminInfo}";
        }

        // –ú–µ—Ç–æ–¥—ã –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö ViewModels
        public void ShowNewsView ( )
        {
            CurrentView = NewsVM;
            IsAuthenticated = true;
            ResetAllButtons(); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏
        }

        public void ShowMainSchedule ( )
        {
            CurrentView = MainScheduleVM;
            SetActiveButton("MainSchedule");
        }

        public void ShowLoginView ( )
        {
            CurrentView = LoginView;
            IsAuthenticated = false;
            CurrentAdminName = string .Empty;
            ResetAllButtons();
        }

        // –ú–µ—Ç–æ–¥ –¥–ª—è —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        public void OnAuthenticationSuccess (string adminName)
        {
            CurrentAdminName = adminName;
            IsAuthenticated = true;
            ShowNewsView(); // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
        }

        // –ú–µ—Ç–æ–¥ –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        public void Logout ( )
        {
            IsAuthenticated = false;
            CurrentAdminName = string .Empty;
            ShowLoginView();
        }
    }
}



namespace ScheduleAppDemo .MVVM .ViewModel
{
   public  class NewsViewModel : ObservableObject
    {
        private MainViewModel _mainViewModel;

        public string AdminName => _mainViewModel?.CurrentAdminName;

        // –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å MainViewModel
        public NewsViewModel (MainViewModel mainViewModel)
        {
            _mainViewModel = mainViewModel;
        }

        // –£–±–µ—Ä–∏—Ç–µ –ø—É—Å—Ç–æ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏–ª–∏ —Å–¥–µ–ª–∞–π—Ç–µ –µ–≥–æ private
        private NewsViewModel ( )
        {
        }
    }

}

using ScheduleAppDemo .Core;
using ScheduleAppDemo .MVVM .Model;
using ScheduleAppDemo .MVVM .Model .Entities;
using ScheduleAppDemo .MVVM .View;
using ScheduleAppDemo .Services;
using System;
using System .Collections .Generic;
using System .Collections .ObjectModel;
using System .Linq;
using System .Text;
using System .Threading .Tasks;
using System .Windows;

namespace ScheduleAppDemo .MVVM .ViewModel
{

    public class ScheduleEditorViewModel : ObservableObject
    {
        // –í—ã–±—Ä–∞–Ω–Ω–∞—è –≥—Ä—É–ø–ø–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        private Group _selectedGroup;
        public Group SelectedGroup
        {
            get => _selectedGroup;
            set
            {
                if ( SetProperty(ref _selectedGroup , value) )
                {
                    OnGroupSelected();
                }
            }
        }

        // –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞
        public ObservableCollection<Group> Groups { get; set; }
        public ObservableCollection<Subject> Subjects { get; set; }
        public ObservableCollection<Teacher> Teachers { get; set; }
        public ObservableCollection<Classroom> Classrooms { get; set; }
        public ObservableCollection<TimeSlot> TimeSlots { get; set; }

        // –¢–∞–±–ª–∏—Ü–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è 6√ó6 (–ø–∞—Ä—ã √ó –¥–Ω–∏)
        public ObservableCollection<ScheduleRow> ScheduleTable { get; set; }

        // –í—ã–±—Ä–∞–Ω–Ω–∞—è —è—á–µ–π–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        private LessonCell _selectedCell;
        public LessonCell SelectedCell
        {
            get => _selectedCell;
            set => SetProperty(ref _selectedCell , value);
        }

        // –ö–æ–º–∞–Ω–¥—ã
        public RelayCommand SaveScheduleCommand { get; }
        public RelayCommand ClearScheduleCommand { get; }

        public ScheduleEditorViewModel ( )
        {
            Groups = new ObservableCollection<Group>();
            Subjects = new ObservableCollection<Subject>();
            Teachers = new ObservableCollection<Teacher>();
            Classrooms = new ObservableCollection<Classroom>();
            TimeSlots = new ObservableCollection<TimeSlot>();
            ScheduleTable = new ObservableCollection<ScheduleRow>();

            SaveScheduleCommand = new RelayCommand(_ => SaveSchedule());
            ClearScheduleCommand = new RelayCommand(_ => ClearSchedule());

            LoadData();
            InitializeEmptyTable();
        }

        private void LoadData ( )
        {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—ã–±–æ—Ä–∞
            var groups = DatabaseHelper .GetAllGroups();
            Groups .Clear();
            foreach ( var group in groups )
            {
                Groups .Add(group);
            }

            var subjects = DatabaseHelper .GetAllSubjects();
            Subjects .Clear();
            foreach ( var subject in subjects )
            {
                Subjects .Add(subject);
            }

            var teachers = DatabaseHelper .GetAllTeachers();
            Teachers .Clear();
            foreach ( var teacher in teachers )
            {
                Teachers .Add(teacher);
            }

            var classrooms = DatabaseHelper .GetAllClassrooms();
            Classrooms .Clear();
            foreach ( var classroom in classrooms )
            {
                Classrooms .Add(classroom);
            }

            var timeSlots = DatabaseHelper .GetTimeSlots();
            TimeSlots .Clear();
            foreach ( var timeSlot in timeSlots )
            {
                TimeSlots .Add(timeSlot);
            }
        }

        private void InitializeEmptyTable ( )
        {
            ScheduleTable .Clear();

            // –°–æ–∑–¥–∞–µ–º 6 —Å—Ç—Ä–æ–∫ (–ø–æ –æ–¥–Ω–æ–π –Ω–∞ –∫–∞–∂–¥—É—é –ø–∞—Ä—É)
            for ( int i = 0 ; i < 6 ; i++ )
            {
                var timeSlot = TimeSlots .Count > i ? TimeSlots[i] : null;
                var row = new ScheduleRow
                {
                    TimeDisplay = timeSlot != null ?
                        $"{timeSlot .StartTime:hh\\:mm}-{timeSlot .EndTime:hh\\:mm}\n{timeSlot .PeriodName}" :
                        $"–ü–∞—Ä–∞ {i + 1}" ,
                    TimeSlotId = i + 1 ,
                    Monday = new LessonCell() ,
                    Tuesday = new LessonCell() ,
                    Wednesday = new LessonCell() ,
                    Thursday = new LessonCell() ,
                    Friday = new LessonCell() ,
                    Saturday = new LessonCell()
                };
                ScheduleTable .Add(row);
            }
        }

        private void OnGroupSelected ( )
        {
            if ( SelectedGroup != null )
            {
                // –ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
                LoadExistingSchedule();
            }
            else
            {
                InitializeEmptyTable();
            }
        }

        private void LoadExistingSchedule ( )
        {
            if ( SelectedGroup == null ) return;

            try
            {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏–∑ –ë–î
                var scheduleEntities = DatabaseHelper .GetScheduleForGroup(SelectedGroup .GroupId);

                // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
                InitializeEmptyTable();

                // –ó–∞–ø–æ–ª–Ω—è–µ–º —è—á–µ–π–∫–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –ë–î
                foreach ( var schedule in scheduleEntities )
                {
                    var row = ScheduleTable .FirstOrDefault(r => r .TimeSlotId == schedule .TimeslotId);
                    if ( row != null )
                    {
                        var lessonCell = CreateLessonCell(schedule);
                        SetDayCell(row , schedule .DayOfWeek , lessonCell);
                    }
                }
            }
            catch ( System .Exception ex )
            {
                MessageBox .Show($"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è: {ex .Message}");
            }
        }

        // –ú–µ—Ç–æ–¥ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —è—á–µ–π–∫–∏
        public void UpdateSelectedCell (LessonCell cell , int dayOfWeek , int timeSlotId)
        {
            SelectedCell = cell;

            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —è—á–µ–π–∫–∏
            if ( cell != null )
            {
                ShowEditDialog(cell , dayOfWeek , timeSlotId);
            }
        }

        private void ShowEditDialog (LessonCell cell , int dayOfWeek , int timeSlotId)
        {
            // –°–æ–∑–¥–∞–µ–º –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ
            var dialogWindow = new Window
            {
                Title = "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è" ,
                Width = 460 ,
                Height = 700 ,
                WindowStartupLocation = WindowStartupLocation .CenterOwner ,
                ResizeMode = ResizeMode .NoResize ,
                WindowStyle = WindowStyle .SingleBorderWindow
            };

            // –°–æ–∑–¥–∞–µ–º UserControl –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            var editDialog = new EditLessonDialog();
            editDialog .DataContext = new EditLessonViewModel(this , cell , dayOfWeek , timeSlotId);

            // –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è
            editDialog .SaveClicked += (s , e) => { dialogWindow .DialogResult = true; };
            editDialog .CancelClicked += (s , e) => { dialogWindow .DialogResult = false; };

            dialogWindow .Content = editDialog;

            if ( dialogWindow .ShowDialog() == true )
            {
                MessageBox .Show("–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!" , "–£—Å–ø–µ—Ö" , MessageBoxButton .OK , MessageBoxImage .Information);
            }
        }
        // –ú–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ –¥–∏–∞–ª–æ–≥–∞
        public void ApplyLessonEdit (LessonCell updatedCell , int dayOfWeek , int timeSlotId)
        {
            var row = ScheduleTable .FirstOrDefault(r => r .TimeSlotId == timeSlotId);
            if ( row != null )
            {
                SetDayCell(row , dayOfWeek , updatedCell);
            }
        }
        private LessonCell CreateLessonCell (Schedule schedule)
        {
            var subject = Subjects .FirstOrDefault(s => s .SubjectId == schedule .SubjectId);
            var teacher = Teachers .FirstOrDefault(t => t .TeacherId == schedule .TeacherId);
            var classroom = Classrooms .FirstOrDefault(c => c .ClassroomId == schedule .ClassroomId);

            return new LessonCell
            {
                ScheduleId = schedule .ScheduleId ,
                SubjectName = subject?.SubjectName ?? "" ,
                TeacherName = teacher?.FullName ?? "" ,
                Classroom = classroom?.RoomNumber ?? "" ,
                SubjectId = subject?.SubjectId ,
                TeacherId = teacher?.TeacherId ,
                ClassroomId = classroom?.ClassroomId ,
                Color = GetLessonColor(subject?.CategoryId)
            };
        }

        private void SetDayCell (ScheduleRow row , int dayOfWeek , LessonCell cell)
        {
            switch ( dayOfWeek )
            {
                case 1: row .Monday = cell; break;
                case 2: row .Tuesday = cell; break;
                case 3: row .Wednesday = cell; break;
                case 4: row .Thursday = cell; break;
                case 5: row .Friday = cell; break;
                case 6: row .Saturday = cell; break;
            }
        }

        private void SaveSchedule ( )
        {
            if ( SelectedGroup == null )
            {
                MessageBox .Show("–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è");
                return;
            }

            try
            {
                System .Diagnostics .Debug .WriteLine("=== –ù–ê–ß–ê–õ–û –°–û–•–†–ê–ù–ï–ù–ò–Ø –†–ê–°–ü–ò–°–ê–ù–ò–Ø ===");
                System .Diagnostics .Debug .WriteLine($"–°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –≥—Ä—É–ø–ø—ã: {SelectedGroup .GroupName} (ID: {SelectedGroup .GroupId})");

                // 1. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
                System .Diagnostics .Debug .WriteLine("–£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ...");
                DatabaseHelper .DeleteScheduleForGroup(SelectedGroup .GroupId);

                // 2. –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
                int lessonCount = 0;
                foreach ( var row in ScheduleTable )
                {
                    for ( int day = 1 ; day <= 6 ; day++ )
                    {
                        var cell = GetDayCell(row , day);
                        if ( cell?.SubjectId != null && cell .TeacherId != null && cell .ClassroomId != null )
                        {
                            var schedule = new Schedule
                            {
                                GroupId = SelectedGroup .GroupId ,
                                TimeslotId = row .TimeSlotId ,
                                DayOfWeek = day ,
                                SubjectId = cell .SubjectId .Value ,
                                TeacherId = cell .TeacherId .Value ,
                                ClassroomId = cell .ClassroomId .Value ,
                                IsRemote = cell .IsRemote
                            };

                            System .Diagnostics .Debug .WriteLine($"–î–æ–±–∞–≤–ª—è–µ–º –∑–∞–Ω—è—Ç–∏–µ: {cell .SubjectName}, –¥–µ–Ω—å {day}, –ø–∞—Ä–∞ {row .TimeSlotId}");
                            DatabaseHelper .AddScheduleItem(schedule);
                            lessonCount++;
                        }
                    }
                }

                System .Diagnostics .Debug .WriteLine($"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∑–∞–Ω—è—Ç–∏–π: {lessonCount}");

                // 3. –£–≤–µ–¥–æ–º–ª—è–µ–º –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
                System .Diagnostics .Debug .WriteLine("–û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏...");
                ScheduleSyncService .Instance .NotifyScheduleUpdated(SelectedGroup);

                MessageBox .Show($"–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –≥—Ä—É–ø–ø—ã {SelectedGroup .GroupName} —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!\n" +
                              $"–î–æ–±–∞–≤–ª–µ–Ω–æ –∑–∞–Ω—è—Ç–∏–π: {lessonCount}" , "–£—Å–ø–µ—Ö" ,
                              MessageBoxButton .OK , MessageBoxImage .Information);

                System .Diagnostics .Debug .WriteLine("=== –°–û–•–†–ê–ù–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û ===");
            }
            catch ( Exception ex )
            {
                System .Diagnostics .Debug .WriteLine($"–û–®–ò–ë–ö–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø: {ex .Message}");
                MessageBox .Show($"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {ex .Message}" , "–û—à–∏–±–∫–∞");
            }
        }

        private void ClearSchedule ( )
        {
            if ( MessageBox .Show("–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ?" , "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ" ,
                MessageBoxButton .YesNo) == MessageBoxResult .Yes )
            {
                InitializeEmptyTable();
            }
        }

        private LessonCell GetDayCell (ScheduleRow row , int dayOfWeek)
        {
            switch ( dayOfWeek )
            {
                case 1: return row .Monday;
                case 2: return row .Tuesday;
                case 3: return row .Wednesday;
                case 4: return row .Thursday;
                case 5: return row .Friday;
                case 6: return row .Saturday;
                default: return null;
            }
        }

        private string GetLessonColor (int? categoryId)
        {
            if ( categoryId == null ) return "#F5F5F5";

            switch ( categoryId .Value )
            {
                case 1: return "#E3F2FD";
                case 2: return "#E8F5E8";
                case 3: return "#FFF3E0";
                case 4: return "#F3E5F5";
                case 5: return "#E0F2F1";
                case 6: return "#FFEBEE";
                case 7: return "#ECEFF1";
                default: return "#F5F5F5";
            }
        }
    }
}

–æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ Theme –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∏–ª–µ–π –∫–Ω–æ–ø–æ–∫ –∏ —Ç–¥.

MAIN WINDOW : 
<Window x:Class="ScheduleAppDemo.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
       xmlns:viewModel="clr-namespace:ScheduleAppDemo.MVVM.ViewModel"
xmlns:view="clr-namespace:ScheduleAppDemo.MVVM.View"
        xmlns:local="clr-namespace:ScheduleAppDemo"
        mc:Ignorable="d"
        Title="MainWindow"
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent">
    
  
    <Border 
        CornerRadius="25"
        Background="#FF010010">

        <Grid Background="Transparent">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions >
                <RowDefinition Height="75"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <TextBlock 
                Text="Schedule App"
                FontSize="35" 
                HorizontalAlignment="Center"
                FontFamily="Arial Black"
                Margin="0,12,0,0" 
                VerticalAlignment="Center"
                Foreground="#FFB583F3">
            </TextBlock>
            <StackPanel Grid.Row="1">

                <RadioButton Content="üìÜ –û—Å–Ω–æ–≤–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ"
                 Command="{Binding MainScheduleViewCommand}"
                 IsChecked="{Binding IsMainScheduleActive}"
                 Height="75" 
                 FontSize="24" 
                 HorizontalAlignment="Left" 
                 Margin="0,10,0,0"
                 Width="295"
                 Style="{StaticResource MenuButtonTheme}"
                 BorderThickness="0,0,0,30" 
                 Foreground="White"
                 FontFamily="Bernard MT Condensed"
                 IsEnabled="{Binding IsAuthenticated}"/>

                <!-- –†–µ–¥–∞–∫—Ç–æ—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è -->
                <RadioButton Content="‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è"
                 Command="{Binding ScheduleEditorViewCommand}"
                 IsChecked="{Binding IsScheduleEditorActive}"
                 Height="75" 
                 FontSize="24" 
                 HorizontalAlignment="Left" 
                 Margin="0,10,0,0"
                 Width="295"
                 Style="{StaticResource MenuButtonTheme}" 
                 BorderThickness="0,0,0,30" 
                 Foreground="White"
                 FontFamily="Bernard MT Condensed"
                 IsEnabled="{Binding IsAuthenticated}"/>

                <!-- –ì—Ä—É–ø–ø—ã -->
                <RadioButton Content="üë• –ì—Ä—É–ø–ø—ã"
                 Command="{Binding GroupsViewCommand}"
                 IsChecked="{Binding IsGroupsActive}"
                 Height="75" 
                 FontSize="24" 
                 HorizontalAlignment="Left" 
                 Margin="0,10,0,0"
                 Width="295"
                 Style="{StaticResource MenuButtonTheme}" 
                 BorderThickness="0,0,0,30"
                 Foreground="White"
                 FontFamily="Bernard MT Condensed"
                 IsEnabled="{Binding IsAuthenticated}"/>

             
            </StackPanel>
            <ContentControl
              Grid.Row="1"
              Grid.Column="1"
              Margin="10"
              Content="{Binding CurrentView}">
                <ContentControl.Resources>
                    <DataTemplate DataType="{x:Type viewModel:LoginViewModel}">
                        <view:LoginView />
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type viewModel:MainScheduleViewModel}">
                        <view:MainScheduleView />
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type viewModel:NewsViewModel}">
                        <view:NewsView />
                    </DataTemplate>
                </ContentControl.Resources>
            </ContentControl>
            <Button 
                 Style="{DynamicResource CloseButtonTheme}"
                Background="{x:Null}"
                   x:Name="CloseAppButton" 
                   Grid.Column="2"
                   Height="50"
                   Width="50"
                   HorizontalAlignment="Right"
                   Margin="10,10,30.2,10" BorderBrush="{x:Null}" Foreground="{x:Null}"
                 Command="{Binding CloseAppCommand}"
                >
                <Image Source="/images/circle-xmark (1).png" 
                       />
                <Button.Resources>
                    <Style  TargetType="Border" >
                <Setter Property="CornerRadius"   Value="50"/>
                 </Style>
                </Button.Resources>
              </Button>
          </Grid>
    </Border>
</Window>

using ScheduleAppDemo .MVVM .ViewModel;
using System;
using System .Collections .Generic;
using System .Linq;
using System .Text;
using System .Threading .Tasks;
using System .Windows;
using System .Windows .Controls;
using System .Windows .Data;
using System .Windows .Documents;
using System .Windows .Input;
using System .Windows .Media;
using System .Windows .Media .Imaging;
using System .Windows .Navigation;
using System .Windows .Shapes;

namespace ScheduleAppDemo
{
    /// <summary>
    /// –õ–æ–≥–∏–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow ( )
        {
            InitializeComponent();
            this .DataContext = new MainViewModel();
        }

        private void RadioButton_Checked (object sender , RoutedEventArgs e)
        {

        }
    }
}








